YUI.add("search-photos-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photos-search"].run(t,this.appContext)}},attributes:{photos:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-photos-search"],listItemIdField:"photoId"}},totalItems:{setter:function(t){return(t=e.AttributeHelpers.coerceInteger(t))<0&&(t=0),t},defaultValue:0},apiParams:{writeOnce:"initOnly"},emptyQuery:{defaultValue:!1}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-photos-search-fetcher"]});YUI.add("photo-selector-limited-rows-photolist-view",(function(e){e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return t.photolistViewClasses&&(t.additionalViewClasses=t.photolistViewClasses),t.photoListConfig=e.merge(t.primaryPhotoListConfig),this.searchUrl=t.searchUrl,this.listId=t.listId,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){return this.appContext.getModel("search-photos-lite-models",this.searchUrl.getId(),{}).then(function(e){this.searchModel=e,e.getValue("totalItems")<=0&&this.set("emptySearch",!0)}.bind(this))},buildContainer:function(){var e="search.YOUR_PHOTOS";return"contacts"===this.listId?e="search.FROM_YOUR_CONTACTS":"everyone"===this.listId&&(e="search.EVERYONES_PHOTOS"),this.setContainerWithTemplate("search-photos-single-row",{emptySearch:this.get("emptySearch"),total:this.searchModel.getValue("totalItems"),singleResult:1===this.searchModel.getValue("totalItems"),viewAll:"#"+this.listId,"photo-list-view":this.subviews["photo-list-view"].get("container"),title:this.intlMessage({intlName:e})}),this},activate:function(){return this.registerEventHandler(this.get("container").on("click",this.handleClick.bind(this))),this},handleClick:function(e){e.halt();var t,i=e.target;i.hasClass("view-more-link")&&(t=i.getDOMNode().href.split("#")[1],this.fire("subviewViewEvent","viewEntireSearchList",{list:t,searchUrl:this.searchUrl}))}},{ATTRS:{emptySearch:{value:!1}}})}),"@VERSION@",{requires:["flickr-view","photo-list-view","hermes-template-search-photos-single-row","search-photos-lite-models"],langBundles:["common","search"]});YUI.add("hermes-template-photo-selector-photo-list-photo-interaction",(function(e,l){var t=e.Template.Handlebars.revive({1:function(e,l,t,n,a){var o,r=e.escapeExpression,i=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'<a href="'+r(e.lambda(null!=(o=null!=(o=null!=l?i(l,"photo"):l)?i(o,"owner"):o)?i(o,"url"):o,l))+'" class="attribution">'+r((i(t,"intlMessage")||l&&i(l,"intlMessage")||e.hooks.helperMissing).call(null!=l?l:e.nullContext||{},{name:"intlMessage",hash:{user:null!=(o=null!=(o=null!=l?i(l,"photo"):l)?i(o,"owner"):o)?i(o,"displayname"):o,intlName:"common.BY_USER"},data:a,loc:{start:{line:7,column:84},end:{line:7,column:154}}}))+"</a>"},compiler:[8,">= 4.3.0"],main:function(e,l,t,n,a){var o,r,i=null!=l?l:e.nullContext||{},s=e.escapeExpression,p=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'<div class="photo-list-photo-interaction">\n\t<div class="square"></div>\n\t<div class="interaction-bar">\n\t\t<div class="text">\n\t\t\t<a href="'+s("function"==typeof(r=null!=(r=p(t,"photoPageUrl")||(null!=l?p(l,"photoPageUrl"):l))?r:e.hooks.helperMissing)?r.call(i,{name:"photoPageUrl",hash:{},data:a,loc:{start:{line:6,column:12},end:{line:6,column:28}}}):r)+'" class="title">'+s(e.lambda(null!=(o=null!=l?p(l,"photo"):l)?p(o,"title"):o,l))+"</a>\n\t\t\t"+(null!=(o=p(t,"if").call(i,null!=(o=null!=(o=null!=l?p(l,"photo"):l)?p(o,"owner"):o)?p(o,"displayname"):o,{name:"if",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:7,column:3},end:{line:7,column:165}}}))?o:"")+'\n\t\t</div>\n\t</div>\n</div>\n<div class="disabled-overlay"></div>\n'},useData:!0}),n={};e.Array.each([],(function(l){var t=e.Template.get("hermes/"+l);t&&(n[l]=t)})),e.Template.register("hermes/photo-selector-photo-list-photo-interaction",(function(l,a){return(a=a||{}).partials=a.partials?e.merge(n,a.partials):n,t(l,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-selector-photolist-interaction-view",(function(t){var e=require("hermes-core/type-validator");t.namespace("Views")[this.name]=t.Base.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.hasMultiSelect=t.primaryPhotoListConfig&&t.primaryPhotoListConfig.hasMultiSelect,this.multiSelectLimit=void 0===t.primaryPhotoListConfig.multiSelectLimit?1:t.primaryPhotoListConfig.multiSelectLimit,this.listType=t.primaryPhotoListConfig.type,this.galleryId=t.primaryPhotoListConfig.galleryId,this.isDisabled=!1,this.isDisabledSelected=!1,this},loadState:function(){var e=this,i=[];return"galleryFaves"===this.listType&&this.galleryId&&(i.push(this.appContext.getModelRegistry("gallery-photo-association-models").then((function(t){t.exists(e.galleryId+"-"+e.get("id"))&&(e.isDisabled=!0,e.isDisabledSelected=!0)}))),i.push(this.appContext.getModel("gallery-faves-models",this.appContext.getViewer().nsid+"-"+e.galleryId).then((function(t){var i=t.getValue("nonGalleryAddablePhotos").getList(),s=!1;i&&(s=i.some((function(t){return t.id===e.get("model").id}))),s&&(e.isDisabled=!0)})))),i.push(this.appContext.getModel("profile-selected-photos-models",this.appContext.getViewer().nsid).then(function(t){t.getValue("photos").getFromListByID(this.get("model").getValue("id"))&&this.set("isActive",!0)}.bind(this))),t.Promise.all(i)},buildContainer:function(){var t=this.get("model");return this.setContainerWithTemplate("photo-selector-photo-list-photo-interaction",{photo:t.toJSON(),photoPageUrl:this.get("photoPageUrl")}),this},activate:function(){var e,i,s=this.get("container"),o=s.one(".disabled-overlay");return this.galleryId&&(e=this.intlMessage({intlName:"gallery.PHOTO_CANT_ADD_TO_GALLERY",mediaType:this.get("model").getValue("mediaType")}),i=this.intlMessage({intlName:"gallery.PHOTO_ALREADY_IN_GALLERY",mediaType:this.get("model").getValue("mediaType")})),this.registerEventHandler(s.on("click",this.selectPhoto.bind(this))),this.hasMultiSelect||this.registerEventHandler(t.on("photoSelector:subviewEvent",this.handleOtherPhotoSelected,this)),this.get("isActive")?this.get("isActive")&&s.addClass("active"):s.removeClass("active"),this.isDisabled&&(s.addClass("disabled"),o.setAttribute("title",e)),this.isDisabledSelected&&(s.addClass("disabled-selected"),o.setAttribute("title",i)),this},selectPhoto:function(e){if(e.halt(),!this.isDisabled)if(this.get("isActive")&&this.hasMultiSelect)this.set("isActive",!1),this.get("container").removeClass("active"),t.fire("photoSelector:subviewEvent",{eventName:"unselectPhotoFromPhotoList",id:this.get("id")});else{if(this.hasMultiSelect)return this.appContext.getModel("profile-selected-photos-models",this.appContext.getViewer().nsid).then(function(e){e.getValue("photos").size()+1<=this.multiSelectLimit&&(this.set("isActive",!0),this.get("container").addClass("active"),t.fire("photoSelector:subviewEvent",{eventName:"selectPhotoFromPhotoList",id:this.get("id")}))}.bind(this));this.set("isActive",!0),this.get("container").addClass("active"),t.fire("photoSelector:subviewEvent",{eventName:"selectPhotoFromPhotoList",id:this.get("id")})}},handleOtherPhotoSelected:function(t){if("selectPhotoFromPhotoList"===t.eventName&&this.get("isActive")){if(t.id===this.get("id"))return;this.set("isActive",!1),this.get("container")._node&&this.get("container").removeClass("active")}}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(t,i){return e.photoId(t)}},model:{writeOnce:"initOnly"},photoPageUrl:{writeOnce:"initOnly"}}})}),"@VERSION@",{requires:["flickr-view","hermes-template-photo-selector-photo-list-photo-interaction","attribute-helpers"],optionalRequires:["fluid","hermes-core"],langBundles:["common","gallery"]});YUI.add("hermes-template-photo-selector-sets-photolist-set-interaction",(function(t,e){var l=t.Template.Handlebars.revive({1:function(t,e,l,n,a){var o,s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t<span class="album-photo-count">'+t.escapeExpression((s(l,"intlMessage")||e&&s(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{selectedCount:null!=(o=null!=e?s(e,"album"):e)?s(o,"publicPhotosCount"):o,intlName:"album-page.PUBLIC_ITEMS_COUNT"},data:a,loc:{start:{line:6,column:36},end:{line:6,column:130}}}))+"</span>\n"},3:function(t,e,l,n,a){var o,s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t<span class="album-photo-count">'+t.escapeExpression((s(l,"intlMessage")||e&&s(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{selectedCount:null!=(o=null!=e?s(e,"album"):e)?s(o,"totalCount"):o,intlName:"album-page.PHOTOS_COUNT"},data:a,loc:{start:{line:8,column:35},end:{line:8,column:116}}}))+"</span>\n"},compiler:[8,">= 4.3.0"],main:function(t,e,l,n,a){var o,s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="photo-list-album-interaction photo-selector-album dark">\n\t<div class="interaction-bar">\n\t\t<h4 class="album-title">'+t.escapeExpression(t.lambda(null!=(o=null!=e?s(e,"album"):e)?s(o,"title"):o,e))+"</h4>\n"+(null!=(o=s(l,"if").call(null!=e?e:t.nullContext||{},null!=e?s(e,"publicOnlyPhotos"):e,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.program(3,a,0),data:a,loc:{start:{line:5,column:2},end:{line:9,column:9}}}))?o:"")+"\t</div>\n</div>\n"},useData:!0}),n={};t.Array.each([],(function(e){var l=t.Template.get("hermes/"+e);l&&(n[e]=l)})),t.Template.register("hermes/photo-selector-sets-photolist-set-interaction",(function(e,a){return(a=a||{}).partials=a.partials?t.merge(n,a.partials):n,l(e,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});