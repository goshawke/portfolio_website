YUI.add("photostream-models",(function(e,t){function r(e){r.superclass.constructor.call(this,e)}e.Models[this.name]=r,e.extend(r,e.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-people-getPhotos"].run(t,this.appContext)}},attributes:{normalizedId:{readOnly:!0,defaultFn:function(e){return e.split("-")[0]}},displayType:{readOnly:!0,defaultFn:function(){return"photostream"}},title:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t,r=this.appContext.getViewer(),n=this.getValue(e,"normalizedId");return r&&r.nsid===n?this.intlMessage({intlName:"models.YOUR_PHOTOSTREAM"}):(t=this.getValue(e,"owner"))?this.intlMessage({intlName:"models.USER_PHOTOSTREAM",name:t.getValue("displayname")}):this.intlMessage({intlName:"models.PHOTOSTREAM"})}},pathAlias:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||void 0},defaultFn:function(e){return this.getValue(e,"normalizedId")}},owner:{isModel:!0},isOwner:e.PhotoModelHelper.attributes.isOwner,photoPageList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getPhotos"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-photos-getContext"],listItemIdField:"photoId"}},url:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.getValue(e,"owner"),r=this.getValue(e,"normalizedId");return"/photos/"+(t?t.getValue("pathAlias"):r)+"/"}},totalItems:{defaultFn:function(){return null}},urlSuffix:{readOnly:!0,defaultFn:function(e){var t,n=r.splitCompoundId(e);return n.orderBy?(t=n.orderBy,n.viewAs?t+="-"+n.viewAs:"dateposted"===n.orderBy&&(t="photostream")):t="photostream",t}}}},{buildCompoundId:function(e,t,r){var n=e;return t&&(n+="-"+t),r&&(t||(n+="-dateposted"),n+="-"+r),n},splitCompoundId:function(e){var t=e.split("-");return{nsid:t[0],orderBy:t[1],viewAs:t[2]}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getContext-fetcher","flickr-people-getPhotos-fetcher","photo-model-helper"],langBundles:["models"]});YUI.add("flutil",(function(e){"use strict";var t,n=e.config.win,r=e.config.doc,o=2e3,i={getPrefixedStyleProperty:{}},a={};t=e.flutil={xbrowser:{transition:{property:"transitionProperty",duration:"transitionDuration",transitionEndEvent:"transitionend"}},setStylePrefixed:function(t,n,r){var o=this.getPrefixedStyleProperty(t);return e.Array.each(o,(function(e){r.setStyle(e,n)})),r},getPrefixedStyleProperty:function(t){if(i.getPrefixedStyleProperty[t])return i.getPrefixedStyleProperty[t];var n=[];return e.Array.each(["-webkit-","-moz-","-ms-",""],(function(e){n.push(e+t)})),i.getPrefixedStyleProperty[t]=n,n},dump:function(){for(var e,t=new Array(arguments.length),n=0;n<t.length;++n)t[n]=arguments[n];e="string"==typeof t[0]?t.shift():"LOG",t.unshift("color: #FC0"),t.unshift("%c["+e+"]"),console.log.apply(console,t)},extend:function(e){e||(e={});for(var t=new Array(arguments.length),n=0;n<t.length;++n)t[n]=arguments[n];return Array.prototype.slice.call(t,1).forEach((function(t){if(t)for(var n in t)e[n]=t[n]})),e},objectCreate:function(e,n){var r,o;return(r=function(){}).prototype=e,o=new r,n?t.extend(o,n):o},result:function(t){return e.Lang.isFunction(t)?t():t},onTransitionEnd:function(e,r){if(r&&"function"==typeof r){var i,a,u,s;if(e=e.getDOMNode(),u=n.getComputedStyle(e)[t.xbrowser.transition.property],s=n.getComputedStyle(e)[t.xbrowser.transition.duration],!u||!s)return r();a=function(){clearTimeout(i),e.removeEventListener(t.xbrowser.transition.transitionEndEvent,a),r()},i=setTimeout(a,o),e.addEventListener(t.xbrowser.transition.transitionEndEvent,a)}},toCamelCase:function(e){return e[0].toUpperCase()+e.slice(1).toLowerCase()},setCookie:function(t){if(!t.cookieName||void 0===t.cookieValue||!t.path)throw new Error("[flutil.setCookie] Missing important parameters to set a cookie");var n=t.cookieName,r=t.cookieValue,o=t.domain||".flickr.com",i=t.path,a=t.expiresMonthsFromNow||3,u=e.Lang.isNumber(t.expires)?t.expires:e.moment().add(a,"months").toDate();t.remove&&e.Cookie.remove(n,{path:i}),e.Cookie.set(n,r,{domain:o,path:i,expires:u})},createFragment:function(e){var t,n=r.createElement("div"),o=r.createDocumentFragment();for(n.innerHTML=e;t=n.firstChild;)o.appendChild(t);return o},constrainToValues:function(e,t){if(!t)throw new Error("Must supply list to constrain to values.");return e&&"string"==typeof e?t.indexOf(e)<0?t[0]:e:t[0]},escapeInput:function(e,t){var n;return r?e||"number"==typeof e?(t||(t="text"),"html"===t?((n=r.createElement("div")).appendChild(r.createTextNode(e)),n.innerHTML):"text"===t?(n=r.createElement("div"),e=e.replace(/(<([^>]+)>\s*)+/gi," ").trim(),n.appendChild(r.createTextNode(e)),n.innerHTML):"numericstring"===t?(e+"").replace(/[^\d]/,""):void 0):"":e},disableEvent:function(n,r){r=e.merge({excepted:":not(*)",onDisabledEvent:null},r),document.body.addEventListener&&(a[n]=a[n]||{},a[n][r.excepted]&&t.enableEvent(n,r.excepted),a[n][r.excepted]=function(t){r.excepted&&e.one(t.target).ancestors(r.excepted,!0).isEmpty()&&(t.preventDefault(),t.stopPropagation(),r.onDisabledEvent&&r.onDisabledEvent(t))},document.body.addEventListener(n,a[n][r.excepted],!0))},enableEvent:function(t,n){n=e.merge({excepted:":not(*)"},n),a[t]&&a[t][n.excepted]&&(document.body.removeEventListener(t,a[t][n.excepted],!0),a[t][n.excepted]=null)},unescape:function(t){if(!t||!e.Lang.isString(t))return t;var n={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#39;":"'","&#039;":"'","&#92;":"\\"};return t.replace(/(&amp;|&lt;|&gt;|&quot;|&#x27;|&#39;|&#039;|&#92;)/gi,(function(e){return n[e.toLowerCase()]}))},normalizeURIComponents:function(e){var t,n,r,o;if(t={"&":["&amp;","&#x00026;","&#38;"],"<":["&lt;","&#x0003C;","&#60;"],">":["&gt;","&#x0003E;","&#62;"],'"':["&quot;","&#x00022;","&#34;"],"'":["&apos;","&#x00027;","&#39;"],"`":["&grave;","&DiacriticalGrave;","&#x00060;","&#96;"]},e){for(n in e=(e=e.replace(/\+/g," ")).replace(/%25/g,"%2525"),t)r=n,o=t[n],e=e.replace(new RegExp(o.join("|"),"gi"),r);return e=decodeURIComponent(e)}},template:function(e,t){return e.replace(/\{\{([\w\.=]+)\}\}/g,(function(e,n){var r,o=n.split(/=/);return r=o[0].split(/\./).reduce((function(e,t){return e?e[t]:null}),t),null!=r?r+"":o[1]||""})).trim()},createHashCode:function(e){var t;return t="object"!=typeof e?e+"":Object.keys(e||{}).map((function(t){var n=t;try{n+=JSON.stringify(e[t])}catch(e){n+="?"}return n})).join(""),t=t.split("").reduce((function(e,t){return(e=(e<<5)-e+t.charCodeAt(0))&e}),0).toString().replace(/^-/,""),"0000000000".slice(0,-1*t.length)+t},camelCaseifyKeys:function(e){return Object.keys(e).reduce((function(n,r){return n[t.camelCaseify(r)]=e[r],n}),{})},camelCaseify:function(e){return e.replace(/-(\w)/gi,(function(e,t){return t.toUpperCase()}))},unCamelCaseify:function(e){return e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()})).replace(/^-/,"")},unicodeVariants:["(?:ae|æ)","(?:oe|œ)","(?:ss|ß)","(?:th|Þ)","[aáàâäãaåấ]","[eéèêëě3]","[iíìîïǐ]","[oóòôöõǒỏơớờởỡợø]","[uúùûüǔǚưứừửữự]","[yýÿ]","[cçč]","[dÐ]","[fƒ]","[gǧ]","[hȟ]","[jǰ]","[kǩ]","[lľ]","[nñň]","[rř®]","[sšṧ]","[tť]","[zž]"],agnosticizeUnicode:function(e){var t,n=this.unicodeVariants,r=n.length;for(t=0;t<r;t++)e=e.replace(new RegExp(n[t],"gi"),n[t]);return e},buildHttpQuery:function(e,t){return e+"?"+Object.keys(t||{}).map((function(e){return e+"="+encodeURIComponent(t[e])})).join("&")},formatNumbers:function(e){return Math.floor(e/1e6)>0?Math.floor(e/1e5)/10+"M":Math.floor(e/1e3)>0?Math.floor(e/100)/10+"K":e},formatIntlPluralNumber:function(t,n,r){var o=e.flutil.formatNumbers(n);return r?t.replace(/(?:\d*[,\.]\d+)+/,o):t.replace(/(?:\d*[,\.\s]\d+)+/,o)},openPopupWindow:function(t,n){var r,o,i,a,u,s;if("undefined"!=typeof window)return o=window,n=e.mix({name:"WIN"+(new Date).getTime(),ui:{}},n||{},!0),(i=e.mix({dependent:!0,status:!0,scrollbars:!0,width:600,height:600},n.ui,!0)).top||(i.top=Math.floor((o.screen.height-i.height)/2)),i.left||(i.left=Math.floor((o.screen.width-i.width)/2)),r=Object.keys(i).map((function(e){var t=i[e];return"boolean"==typeof t&&(t=t?"yes":"no"),e+"="+t})).join(","),(o=o.open(t,n.name,r)).focus(),(n.onUrlChange||n.onClose)&&(a="_start_",s=setInterval((function(){if(!o.location)return clearInterval(s),void(n.onClose&&n.onClose());try{u=o.location.href||"x-origin"}catch(t){o.postMessage("",e.url())}u!==a&&(a=u,n.onUrlChange&&n.onUrlChange(u))}),1e3)),o},parseYYYYMMDDDatestamp:function(t){return e.Lang.isString(t)&&8===t.length?Date.parse(t.substr(0,4)+"-"+t.substr(4,2)+"-"+t.substr(6,2)):null},photoCoords:{normalize:function(e,t,n,r){return{x:e/500,y:t/375,w:n/500,h:r/375}},denormalize:function(e){return{x:500*e.x,y:375*e.y,w:500*e.w,h:375*e.h}},denormX:function(e){return 500*e.x},denormY:function(e){return 375*e.y},denormW:function(e){return 500*e.w},denormH:function(e){return 375*e.h}},getGroupsOptoutValues:function(t){var n=[];return!0===t["rebootify-group-members"]&&n.push({name:"groups_members_opt",value:0}),!0===t["enable-groups-discussion-optout"]&&n.push({name:"groups_discuss_opt",value:0}),!0===t["enable-groups-optout"]&&n.push({name:"groups_opt",value:0}),{url:e.url("/help/forum/en-us/72157645851675914/lastpage#reply"),flippers:n}},nonLockingSynchronousLoop:function(e,t,n,r){var o,i=0,a=!0,u=Object.keys(e),s=function(e){t(e),++i>=c?n():i===o||a?(i===o&&(o+=r.threshold),a=!1,setTimeout((function(){s(u[i])}),1)):s(u[i])},c=u.length;(r=r||{}).threshold=r.threshold||1e3,o=r.threshold,a=!1!==r.earlyUnlock,s(u[i])},shuffleFisherYates:function(e){for(var t,n,r=e.slice(0),o=r.length;0!==o;)n=Math.floor(Math.random()*o),t=r[o-=1],r[o]=r[n],r[n]=t;return r}}}),"@VERSION@",{requires:["url","moment"]});YUI.add("search-helper",(function(e){var t=require("hermes-core/type-validator"),a=["q","ss","ct","mt","l","s","w","d","m","hd","b","a","g","e","cm","xel","xeh","xal","xah","xfl","xfh","eui"],s={userId:"user_id",groupId:"group_id",groupPathAlias:"group_path_alias",setId:"set_id",page:"page",text:"text",tags:"tags",tagMode:"tag_mode",sort:"sort",safeSearch:"safe_search",contentType:"content_type",videoContentTypes:"video_content_types",contentTypes:"content_types",mediaType:"media",license:"license",faves:"faves",contacts:"contacts",getty:"is_getty",commons:"is_commons",marketplace:"marketplace_licensable",minTakenDate:"min_taken_date",maxTakenDate:"max_taken_date",minUploadDate:"min_upload_date",maxUploadDate:"max_upload_date",hasGeo:"has_geo",boundingBox:"bbox",accuracy:"accuracy",woeId:"woe_id",camera:"camera",minExposure:"exif_min_exposure",maxExposure:"exif_max_exposure",minAperture:"exif_min_aperture",maxAperture:"exif_max_aperture",minFocalLength:"exif_min_focallen",maxFocalLength:"exif_max_focallen",excludeUserId:"exclude_user_id",foursquareWoeId:"foursquare_woeid",foursquareVenueId:"foursquare_venueid",slideshowStartId:"jump_to",height:"height",width:"width",dimensionSearchMode:"dimension_search_mode",orientation:"orientation",colorCodes:"color_codes",styles:"styles",similarityId:"similarity_id"},r={relevant:"relevance",recent:"date-posted-desc",interesting:"interestingness-desc",name:"exact-name-match-first",activity:"most-activity",size:"most-members",oldest:"oldest-first",newest:"recent-first",oldestJoined:"age",mostPhotos:"pho",dateUploaded:"date-posted-desc",dateTaken:"date-taken-desc"},n=["s","q","see","m"],o={username:"username",userId:"user_id",sort:"sort",safeSearch:"safe_search"},i=["q","s","m"],c={text:"text",sort:"sort",safeSearch:"safe_search",userId:"user_id",subscriptionTypes:"subscription_types",filterInactive:"filter_inactive_groups"},d={all:"0,1,2,3,4,5,6,7,8,9,10",cc:"1,2,3,4,5,6,9",deriv:"1,2,4,5,9,10",comm:"4,5,6,9,10",commderiv:"4,5,9,10"},l=[s.tags,s.tagMode,s.mediaType,s.videoContentTypes,s.contentTypes,s.minTakenDate,s.maxTakenDate,s.minUploadDate,s.maxUploadDate,s.height,s.width,s.dimensionSearchMode,s.orientation,s.marketplace,s.excludeUserId],u=[s.colorCodes,s.styles],m=[s.sort,s.safeSearch,s.license],p=[s.userId,s.groupId,s.faves,s.contacts,s.commons,"m","w"],h=[s.userId,s.groupId,s.faves,s.contacts,s.safeSearch,s.sort,s.license,s.tags,s.text],f={sort:r.relevant,parse_tags:"1"};function g(e,t){var a;for(a in d){if(!t&&a===e)return d[a];if(t&&d[a]===e)return a}}e.SearchHelper={API:s,PHOTOS_SAFE_SEARCH_SETTINGS:{safe:1,moderate:2,restricted:3},PEOPLE_SEARCH_API:o,GROUPS_SEARCH_API:c,SEARCH_TO_ACCOUNT_SAFE_SEARCH_SETTINGS:{1:0,2:1,3:2},GROUPS_SAFE_SEARCH_SETTINGS:{safe:1,all:3},API_SORT_OPTIONS:r,API_ORIENTATION_OPTIONS:{portrait:"portrait",square:"square",landscape:"landscape",panorama:"panorama"},LICENSE_TYPE:d,UNIFIED_STATE_PARAMS:{viewAll:"view_all",viewType:"view_type",advanced:"advanced",albums:"album_search"},UNIFIED_ADVANCED_PARAMS:l,UNIFIED_QUICK_FILTER_PARAMS:u,UNIFIED_TOOLBAR_PARAMS:m,SEARCH_SCOPE_PARAMS:p,UNIFIED_DEFAULT_PARAMS:f,decodeContentType:function(e){var t={};switch(parseInt(e,10)){case 1:t.photos=!0;break;case 2:t.screenshots=!0;break;case 3:t.other=!0;break;case 4:t.photos=!0,t.screenshots=!0;break;case 5:t.other=!0,t.screenshots=!0;break;case 6:t.photos=!0,t.other=!0;break;default:t.photos=!0,t.screenshots=!0,t.other=!0}return t},encodeContentType:function(e){var t=0;return!e.photos||e.screenshots||e.other?e.photos||!e.screenshots||e.other?e.photos||e.screenshots||!e.other?e.photos&&e.screenshots&&!e.other?t=4:!e.photos&&e.screenshots&&e.other?t=5:e.photos&&!e.screenshots&&e.other?t=6:e.photos&&e.screenshots&&e.other&&(t=7):t=3:t=2:t=1,t},isParameterlessSearch:function(e){return!(e[s.userId]||e[s.groupId]||e[s.tags]||e[s.text]||e[s.license]||e[s.faves]||e[s.contacts]||e[s.getty]||e[s.commons]||e[s.minTakenDate]||e[s.maxTakenDate]||e[s.minUploadDate]||e[s.maxUploadDate]||e[s.hasGeo]||e[s.boundingBox]||e[s.woeId]||e[s.camera]||e[s.minExposure]||e[s.maxExposure]||e[s.minAperture]||e[s.maxAperture]||e[s.minFocalLength]||e[s.maxFocalLength]||e[s.foursquareWoeId]||e[s.foursquareVenueId]||e[o.username]||e[s.similarityId])},mapRouteParamsToAPI:function(e){var a,r={nsid_or_path_alias:"userId",group_id:"groupId",set_id:"setId",page_number:"page",tag_list:"tags",location:"text",slideshow_start_id:"slideshowStartId"},n={};for(a in r)e[a]&&(n[s[r[a]]]=e[a]);return n[s.groupId]&&!t.nsid(n[s.groupId])&&(n[s.groupPathAlias]=n[s.groupId],delete n[s.groupId]),n},convertLicenseTypeValue:g,mapClassicSearchToAPI:function(n,o){if(!n)return{};var i,c,l,u,m={},p=o.getViewer(),h=n.l,f=n.s,g=n.w,_=n.m,I=n.q;if(n.d&&"string"==typeof n.d&&(l=n.d.split("-")),n.q&&(m[s.text]=n.q),void 0!==n.ss&&(m[s.safeSearch]=parseInt(n.ss,10)+1),void 0!==n.ct&&(m[s.contentTypes]=n.ct),void 0!==n.mt&&(m[s.mediaType]=n.mt),n.b&&(m[s.boundingBox]=n.b),n.a&&(m[s.accuracy]=n.a),n.e&&(m[s.woeId]=n.e),n.g&&(m[s.groupId]=n.g),n.cm&&(m[s.camera]=n.cm),void 0!==n.xel&&(m[s.minExposure]=n.xel),void 0!==n.xeh&&(m[s.maxExposure]=n.xeh),void 0!==n.xal&&(m[s.minAperture]=n.xal),void 0!==n.xah&&(m[s.maxAperture]=n.xah),void 0!==n.xfl&&(m[s.minFocalLength]=n.xfl),void 0!==n.xfh&&(m[s.maxFocalLength]=n.xfh),n.eui&&(m[s.excludeUserId]=n.eui),void 0!==h)switch(h){case"cc":case"comm":case"deriv":case"commderiv":m[s.license]=d[h];break;default:(c=parseInt(h,10))>=0&&c<=10&&(m[s.license]=c)}if(f)switch(f){case"rec":m[s.sort]=r.recent;break;case"rel":m[s.sort]=r.relevant;break;case"int":m[s.sort]=r.interesting}if(n.hd&&(m[s.media]="hdvideo"),g&&"string"==typeof g)if(-1!==g.indexOf("faves"))u=g.split("-"),m[s.faves]=1,u.length>1?m[s.userId]=u[1]:p.signedIn&&(m[s.userId]=p.nsid);else if(t.nsid(g))"pool"===_?m[s.groupId]=g:m[s.userId]=g;else switch(g){case"contacts":m[s.contacts]="all";break;case"ff":m[s.contacts]="ff";break;case"getty":m[s.getty]="true";break;case"commons":m[s.commons]="true";break;case"usg":m[s.license]=8}if(l)switch(l[0]){case"taken":l[1]&&(m[s.minTakenDate]=e.flutil.parseYYYYMMDDDatestamp(l[1])/1e3),l[2]&&(m[s.maxTakenDate]=e.flutil.parseYYYYMMDDDatestamp(l[2])/1e3);break;case"posted":l[1]&&(m[s.minUploadDate]=e.flutil.parseYYYYMMDDDatestamp(l[1])/1e3),l[2]&&(m[s.maxUploadDate]=e.flutil.parseYYYYMMDDDatestamp(l[2])/1e3)}if(_&&I&&"tags"===_)delete(m=e.merge(m,this.processTags(I)))[s.text];for(i in n)-1===a.indexOf(i)&&(m[i]=n[i]);return m},mapClassicPeopleSearchToAPI:function(e,t){var a={},s=null,i=t.getViewer();if((e=e||{}).q&&(a[o.username]=e.q),e.s)switch(e.s){case"age":a[o.sort]=r.oldestJoined;break;case"pho":a[o.sort]=r.mostPhotos}for(s in e.see&&"all"===e.see.toString().toLowerCase()&&i.signedIn&&(a[o.userId]=i.nsid),e.m&&(e.m.toString().toLowerCase(),e.m.toString().toLowerCase()),e)-1===n.indexOf(s)&&(a[s]=e[s]);return a},mapClassicGroupSearchToApi:function(e,t){var a,s={},n=null;if(a=(e=e||{}).m&&"discuss"===e.m.toString().toLowerCase(),e.q&&(s[c.text]=e.q),e.s)switch(e.s){case"act":s[c.sort]=a?r.discussionActivity:r.activity;break;case"siz":s[c.sort]=r.size;break;case"age":s[c.sort]=r.newest}for(n in e)-1===i.indexOf(n)&&(s[n]=e[n]);return s},mapAPIParamsToAdvancedSearchQuery:function(e){var t={},a=e[s.userId];return e[s.text]?t.q=e[s.text]:e[s.tags]&&(t.q=e[s.tags]),e[s.faves]?t.w=a?"faves-"+a:"faves":a?t.w=a:"all"===e[s.contacts]?t.w="contacts":"ff"===e[s.contacts]?t.w="ff":"true"===e[s.getty]?t.w="getty":"true"===e[s.commons]?t.w="commons":8===parseInt(e[s.license],10)&&(t.w="usg"),e[s.license]&&(t.l=g(e[s.license],!0)),t},deriveScopeTitle:function(a,r){var n,o=r.getViewer();return a[s.userId]?o&&o.signedIn&&o.nsid===a[s.userId]?a[s.faves]?e.Promise.resolve({intlName:"search.VIEWER_FAVES"}):e.Promise.resolve({intlName:"search.YOUR_PHOTOS"}):(n=t.nsid(a[s.userId])?a[s.userId]:{pathAlias:a[s.userId]},r.getModel("person-models",n).then((function(e){return{intlName:a[s.faves]?"search.FAVES_POSSESSIVE":"search.PHOTOS_POSSESSIVE",name:e.getValue("displayname")}}))):a[s.contacts]?e.Promise.resolve({intlName:"search.FROM_PEOPLE_YOU_FOLLOW"}):a[s.groupId]||a[s.groupPathAlias]?(n=a[s.groupId]?{id:a[s.groupId]}:{pathAlias:a[s.groupPathAlias]},r.getModel("group-info-models",n).then((function(e){return{intlName:"search.IN_GROUP_POOL",name:e.getValue("group").getValue("title")}}))):a[s.faves]?e.Promise.resolve({intlName:"search.VIEWER_FAVES"}):e.Promise.resolve({intlName:"search.EVERYONES_PHOTOS"})},derivePeopleScopeTitle:function(a,r){var n,o=r.getViewer();if(a[s.userId])return o&&o.signedIn&&o.nsid===a[s.userId]?e.Promise.resolve({intlName:"search.PEOPLE_YOU_FOLLOW"}):(n=t.nsid(a[s.userId])?a[s.userId]:{pathAlias:a[s.userId]},r.getModel("person-models",n).then((function(e){return{intlName:"search.CONTACTS_POSSESSIVE",name:e.getValue("username")}})))},deriveGroupsScopeTitle:function(a,r){var n,o=r.getViewer();if(a[s.userId])return o&&o.signedIn&&o.nsid===a[s.userId]?e.Promise.resolve({intlName:"search.YOUR_GROUPS"}):(n=t.nsid(a[s.userId])?a[s.userId]:{pathAlias:a[s.userId]},r.getModel("person-models",n).then((function(e){return{intlName:"search.GROUPS_POSSESSIVE",name:e.getValue("username")}})))},deriveCCLicenseString:function(e){e||(e={});var t=null,a=e[s.license];if(a&&1===a.length)switch(parseInt(a,10)){case 1:t="search.CC_BY_NC_SA";break;case 2:t="search.CC_BY_NC";break;case 3:t="search.CC_BY_NC_ND";break;case 4:t="search.CC_BY";break;case 5:t="search.CC_BY_SA";break;case 6:t="search.CC_BY_ND"}return t?{intlName:t}:null},addParamDefaults:function(e,t){!e[s.license]||e[s.license]!==d.all&&""!==e[s.license]||delete e[s.license]},addGroupsParamDefaults:function(e){},addPeopleParamDefaults:function(e){},clearParams:function(e,t){for(var a in e)-1===t.indexOf(a)&&delete e[a]},clearAdvancedSearchParams:function(e){this.clearParams(e,h)},clearParamsExceptSearchScope:function(e){this.clearParams(e,p)},generateQueryString:function(t){var a=e.clone(t)||{};return delete a.page,delete a.method,delete a.extras,e.QueryString.stringify(a)},convertSafeSearchPrefsToApi:function(t){var a=e.AttributeHelpers.coerceInteger(t);return e.AttributeHelpers.coerceString(a+1)},unescapeParameters:function(t){var a=t[s.groupId],r=t[s.tags],n=t[s.text];YUI.Env.isServer&&(a&&(t[s.groupId]=e.flutil.unescape(a)),r&&(t[s.tags]=e.flutil.unescape(r)),n&&(t[s.text]=e.flutil.unescape(n)))},objectsAreEquivalentToDepth:function(t,a,s){var r,n,o=this;return t===a||!(s<=0)&&(s=s||1,!(!e.Lang.isObject(t)||!e.Lang.isObject(a))&&(r=Object.keys(t),n=Object.keys(a),r.length===n.length&&r.every((function(e){return o.objectsAreEquivalentToDepth(t[e],a[e],s-1)}))))},normalizeTag:function(e){var t;return e&&(t=e.replace(/[\s!-\/:-@[-`]/g,"")),t},processTags:function(e,t){if(!e||"string"!=typeof e)return{};var a,r,n,o={},i=/(["'])(\\?.)*?\1/g,c=/^([,\+]|AND|OR)$/;return a=e.match(i)||[],r=(r=e.replace(i,"").split(/[,\+\s]/)).map((function(e){return e.trim()})).filter((function(e){return e&&!c.test(e)})),n=a.concat(r),o[s.tags]=n.join(","),"any"===t||"all"===t?o[s.tagMode]=t:/[\+\s]OR[\+\s]/.test(e)?(o[s.tagMode]="any",n.length=Math.min(n.length,11)):o[s.tagMode]="all",o}}}),"@VERSION@",{requires:["flutil"],optionalRequires:["hermes-core"]});YUI.add("notification-models",(function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,attributes:{id:{},isSeen:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},isMuted:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},type:{validator:function(e,r){return t.AttributeHelpers.validateString(e)},setter:function(e){return t.AttributeHelpers.coerceString(e)}},timestamp:{validator:function(e,r){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)}},activityData:{},eventDataList:[],userModels:[],activityEntityModels:{},eventEntityModelsList:[]}})}),"@VERSION@",{requires:["flickr-model-registry"]});YUI.add("contact-models",(function(e){"use strict";function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{pathAlias:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||void 0},defaultFn:function(e){return e}},username:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},realname:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},displayname:{readOnly:!0,derivedBy:["username","realname"],getter:function(e,t){return this.getValue(t,"realname")||this.getValue(t,"username")}},iconfarm:{},iconserver:{},buddyicon:{},nsid:{readOnly:!0,defaultFn:function(e){return e}},isMe:{readOnly:!0,defaultFn:function(e){var t=this.appContext.getViewer();return t.signedIn&&t.nsid===e}},isPro:{defaultValue:!1,setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},proBadge:{defaultValue:"standard",setter:function(t){return e.AttributeHelpers.coerceString(t)}},profileURL:{readOnly:!0,derivedBy:["pathAlias","nsid"],defaultFn:function(e){var t=this.getValue(e,"pathAlias");return t||(t=e),"/photos/"+t}},followsURL:{readOnly:!0,derivedBy:["pathAlias","nsid"],defaultFn:function(e){var t=this.getValue(e,"pathAlias");return t||(t=e),"/people/"+t+"/contacts"}}}})}),"@VERSION@",{requires:["flickr-model-registry","attribute-helpers","url-helper"]});YUI.add("flickr-activity-recentByType-fetcher",(function(t,e){"use strict";t.namespace("ListFetchers")["flickr-activity-recentByType"]={run:function(i,o){var n=this,s=this._processParams(i);return new t.FlickrPromise({apiResponse:o.callAPI("flickr.activity.recentByType",s),notificationModelRegistry:o.getModelRegistry("notification-models"),notificationsModelRegistry:o.getModelRegistry("person-notifications-models")}).then((function(t){return n._processResponse(t,i,s,o)}),t.FetcherErrorLogger(e))},_processParams:function(e){var i={extras:["sizes","icon_urls","ignored","rev_ignored","tags","autotags","datecreate"].join(",")+","+t.APIHelper.request.getRebootPhotoExtras(),count:30,per_object:12,secure_image_embeds:1,max_users:2,notification_groups:e.notificationGroups||"default"};return e.muteFilter&&(i.mute_filter=e.muteFilter),e.onlyGroupId&&(i.only_group_id=e.onlyGroupId),"continuation"in e?i.continuation=e.continuation:"page"in e&&(i.page=e.page,i.per_page=e.perPage),i},_processResponse:function(e,i,o,n){var s=e.apiResponse,a=e.notificationModelRegistry,r=e.notificationsModelRegistry,c=[],u=new t.NotificationsHelper(n);return s.items?(s.items.item.forEach((function(e){var i=e.events||[],o={id:t.guid(),isSeen:1===e.seen||!0===e.seen,isMuted:!!e.is_muted,type:e.type,timestamp:e.date,activityData:e,eventDataList:i};c.push(u.extractEntitiesFromResponse(o).then((function(t){var o={id:e.id,isSeen:e.seen,isMuted:!!e.is_muted,type:e.type,timestamp:e.date,activityData:e,eventDataList:i,userModels:t.userModels,activityEntityModels:t.activityEntityModels,eventEntityModelsList:t.eventEntityModelsList};return a.addOrUpdate(o)})))})),t.Promise.all(c).then((function(t){var e,n,a,c={id:i.id};return"continuation"in o?(e=r.addOrUpdate(c),"0"===o.continuation&&(n=e.getValue("initialNotificationsData")||{},a="notificationGroups="+i.notificationGroups,i.muteFilter&&(a+="&muteFilter="+i.muteFilter),i.onlyGroupId&&(a+="&onlyGroupId="+i.onlyGroupId),n[a]=n[a]||{token:s.continuation,list:t},e.setValue("initialNotificationsData",n)),{notificationModels:t,continuation:s.continuation}):"page"in o?(r.exists(i.id)?r.getValue(i.id,"notifications").addPage({page:o.page,perPage:o.per_page,pageContent:t,totalItems:parseInt(s.items.total||0,10)}):(c.notifications=t,r.add(c)),t):void 0}))):t.Promise.resolve(Object.assign(s,{notificationModels:[]}))}}}),"@VERSION@",{requires:["flickr-promise","search-helper","querystring-parse-simple"],optional:["url-helper","notification-models","person-notifications-models","contact-models","photo-models","notification-models"]});YUI.add("flickr-notifications-markread-updater",(function(r,i){"use strict";r.namespace("ModelUpdaters")["flickr-notifications-markread"]={run:function(e,a){return a.callAPI("flickr.notifications.markread",e).then(null,r.FetcherErrorLogger(i))}}}),"@VERSION@",{requires:["flickr-promise"]});YUI.add("flickr-activity-getNotificationsCount-fetcher",(function(t,i){"use strict";t.namespace("ModelFetchers")["flickr-activity-getNotificationsCount"]={run:function(e,o){var n=this,s=this._processParams(e);return t.FlickrPromise({apiResponse:o.callAPI("flickr.activity.getNotificationsCount",s),personNotifsModelRegistry:o.getModelRegistry("person-notifications-models")}).then((function(t){return n._processResponse(t,o,s)}),t.FetcherErrorLogger(i))},_processParams:function(i){var e=i.notification_groups||"default,hermes_2020,groups_you_admin,bot_moderation";return t.merge(i,{notification_groups:e})},_processResponse:function(t,i,e){var o=t.apiResponse,n=t.personNotifsModelRegistry,s=n.getValue(e.id,"unseenNotificationCounts")||{};return n.setValue(e.id,"unseenNotificationCount",o.activity.count),n.setValue(e.id,"unseenNotificationCounts",Object.assign(s,o.activity)),o.activity.count}}}),"@VERSION@",{requires:["flickr-promise"],optional:["person-notifications-models","api-helper"]});