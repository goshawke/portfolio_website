YUI.add("flickr-groups-leave-deletor",(function(e,r){"use strict";e.namespace("ModelDeletors")["flickr-groups-leave"]={run:function(o,l){var t={};return t.group_id=o.groupModel.id,t.delete_photos=o.deletePhotos,e.Promise.all([l.callAPI("flickr.groups.leave",t)]).then((function(e){if("ok"===e[0].stat)return o.groupModel.leave(),o.groupModel}),e.FetcherErrorLogger(r))}}}),"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("flickr-favorites-add-updater",(function(r,e){"use strict";r.namespace("ModelUpdaters")["flickr-favorites-add"]={run:function(o,t){var a={};return a.photo_id=o.photoId,t.callAPI("flickr.favorites.add",a).then(null,r.FetcherErrorLogger(e))}}}),"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("flickr-favorites-remove-updater",(function(r,e){"use strict";r.namespace("ModelUpdaters")["flickr-favorites-remove"]={run:function(o,i){var t={};return t.photo_id=o.photoId,t.user_id=o.userId,i.callAPI("flickr.favorites.remove",t).then(null,r.FetcherErrorLogger(e))}}}),"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("flickr-photos-geo-setLocation-updater",(function(o,t){"use strict";o.namespace("ModelUpdaters")["flickr-photos-geo-setLocation"]={run:function(e,r){return r.callAPI("flickr.photos.geo.setLocation",e).then(null,o.FetcherErrorLogger(t))}}}),"@VERSION@");YUI.add("photo-geo-models",(function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{read:function(e){return t.ModelFetchers["flickr-photos-getInfo"].run(e,this.appContext).then((function(t){return t}),(function(){}))},update:function(e,r){var i={photo_id:e,lat:this.getValue(e,"latitude"),lon:this.getValue(e,"longitude")};return r.hasOwnProperty("accuracy")&&(i.accuracy=this.getValue(e,"accuracy")),(r.hasOwnProperty("isPublic")||r.hasOwnProperty("isContact")||r.hasOwnProperty("isFriend")||r.hasOwnProperty("isFamily"))&&(i.is_public=Number(this.getValue(e,"isPublic")),i.is_contact=Number(this.getValue(e,"isContact")),i.is_friend=Number(this.getValue(e,"isFriend")),i.is_family=Number(this.getValue(e,"isFamily"))),t.ModelUpdaters["flickr-photos-geo-setLocation"].run(i,this.appContext)}},attributes:{hasGeo:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},latitude:{validator:function(e,r){return t.AttributeHelpers.validateFloat(e)},setter:function(e){return t.AttributeHelpers.coerceFloat(e)||void 0},defaultValue:void 0},longitude:{validator:function(e,r){return t.AttributeHelpers.validateFloat(e)},setter:function(e){return t.AttributeHelpers.coerceFloat(e)||void 0},defaultValue:void 0},accuracy:{validator:function(e,r){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(Math.max(1,Math.min(e,16)))||void 0},defaultValue:1},isPublic:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},isContact:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},isFriend:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},isFamily:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-photos-getInfo-fetcher","attribute-helpers","flickr-photos-geo-setLocation-updater"]});YUI.add("photo-location-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}t.SUPPORTED_WOE_LEVELS=["neighbourhood","locality","county","region","country","continent"],e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext).then((function(e){return e}),(function(){}))}},attributes:{geo:{isModel:!0},hasGeo:{readOnly:!0,derivedBy:["geo"],defaultFn:function(e){var t=this.getValue(e,"geo");return!!t&&t.getValue("hasGeo")}},latitude:{readOnly:!0,derivedBy:["geo"],defaultFn:function(e){var t=this.getValue(e,"geo");return t?t.getValue("latitude"):null}},longitude:{readOnly:!0,derivedBy:["geo"],defaultFn:function(e){var t=this.getValue(e,"geo");return t?t.getValue("longitude"):null}},levels:{},text:{},mostSpecificWoeId:{readOnly:!0,derivedBy:["levels"],defaultFn:function(e){var n,o=this.getValue(e,"levels");return t.SUPPORTED_WOE_LEVELS.some((function(e){if(o[e]&&o[e].woeId)return n=o[e].woeId,!0})),n}},mostSpecificLevelIndex:{readOnly:!0,derivedBy:["levels"],defaultFn:function(e){var n,o=this.getValue(e,"levels");return t.SUPPORTED_WOE_LEVELS.some((function(e,t){if(o[e]&&o[e].woeId)return n=t,!0})),n}},staticMaps:{}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getInfo-fetcher","attribute-helpers"]});YUI.add("flickr-photos-getLocation-fetcher",(function(e,o){"use strict";e.namespace("ModelFetchers")["flickr-photos-getLocation"]={run:function(t,n){var i={photo_id:t.id,extras:"venue"},s=this;return e.APIHelper.request.addStaticMapsParams(i,n),e.Promise.all([n.callAPI("flickr.photos.geo.getLocation",i),n.getModelRegistry("photo-location-models"),n.getModelRegistry("photo-geo-models")]).then((function(e){var o=e[0],t=e[1],n=e[2],i=s.mapResponse(o,n);return t.addOrUpdate(i),i}),e.FetcherErrorLogger(o))},mapResponse:function(o,t){var n,i,s=o.photo||{},a=s.location||null,r=s.staticMaps&&s.staticMaps.staticMap||null,l=s.venues?s.venues.venue:null,c=[];return i={id:s.id,levels:{}},a?(n={id:s.id,hasGeo:!0,latitude:a.latitude,longitude:a.longitude,accuracy:a.accuracy},e.Models["photo-location-models"].SUPPORTED_WOE_LEVELS.forEach((function(e){a[e]&&(i.levels[e]={name:a[e].content||null,woeId:a[e].woeid||null})})),s.geoperms&&(n.isPublic=s.geoperms.ispublic,n.isContact=s.geoperms.iscontact,n.isFriend=s.geoperms.isfriend,n.isFamily=s.geoperms.isfamily)):n={id:s.id,hasGeo:!1},i.geo=t.addOrUpdate(n),l&&(i.levels.venue={name:l.content||l.address||null,woeId:l.woe_id,source:l.source,venueId:l.id,venueLat:l.latitude,venueLong:l.longitude},l.content&&c.push(l.content),l.city&&c.push(l.city),l.country&&c.push(l.country),i.text=c.join(", ")),i.text||(i.text=(function(e){var o,t,n,i=[];o=[["venue","locality","region"],["neighbourhood","locality","region"],["locality","region","country"],["county","region","country"]];for(;o.length&&i.length<3;)for(t=o.shift(),i=[];t.length&&i.length<3;)e[n=t.shift()]&&e[n].name&&i.push(e[n].name);return i.join(", ")})(i.levels)),e.Lang.isArray(r)&&(i.staticMaps={},r.forEach((function(e){i.staticMaps["zoom"+e.zoom]=e}))),i}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-geo-models","photo-location-models"]});