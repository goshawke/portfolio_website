YUI.add("flickr-activity-muteObject-updater",(function(e,t){"use strict";e.namespace("ModelUpdaters")["flickr-activity-muteObject"]={run:function(r,c){var i=r;return c.callAPI("flickr.activity.muteObjectByType",i).then(null,e.FetcherErrorLogger(t))}}}),"@VERSION@",{requires:["flickr-promise"]});YUI.add("flickr-activity-unmuteObject-updater",(function(e,t){"use strict";e.namespace("ModelUpdaters")["flickr-activity-unmuteObject"]={run:function(r,c){var i=r;return c.callAPI("flickr.activity.unmuteObjectByType",i).then(null,e.FetcherErrorLogger(t))}}}),"@VERSION@",{requires:["flickr-promise"]});YUI.add("person-notifications-models",(function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{read:function(e){return t.ModelFetchers["flickr-people-getInfo"].run(e,this.appContext)},readUnseenNotificationCount:function(e,n){return t.ModelFetchers["flickr-activity-getNotificationsCount"].run(e,n)},updateMutedObjects:function(e,n){return t.ModelUpdaters["flickr-activity-muteObject"].run(e,n)},updateUnmutedObjects:function(e,n){return t.ModelUpdaters["flickr-activity-unmuteObject"].run(e,n)}},remoteReadUnseenNotificationCount:function(t,e,n){return this.setValue(t,"unseenLastFetchedTimestamp",Date.now()),this.remote.readUnseenNotificationCount(e,n)},remoteUpdateMutedObjects:function(t,e,n){var r=this;return this.remote.updateMutedObjects(e,n).then((function(e){return r.setValue(t,"muteChanged",!0),e}))},remoteUpdateUnmutedObjects:function(t,e,n){var r=this;return this.remote.updateUnmutedObjects(e,n).then((function(e){return r.setValue(t,"muteChanged",!0),e}))},getNotificationsByContinuation:function(e,n){var r=Object.assign(n,{id:e});return t.ListFetchers["flickr-activity-recentByType"].run(r,this.appContext)},attributes:{id:{setter:function(t){return t||this.appContext.getViewer().nsid}},unseenNotificationCount:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)},defaultValue:0},unseenNotificationCounts:{},unreadFlickrMailCount:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)},defaultValue:0},unseenLastFetchedTimestamp:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)},defaultValue:0},muteChanged:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},initialNotificationsData:{}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-activity-recentByType-fetcher","flickr-notifications-markread-updater","flickr-people-getInfo-fetcher","flickr-activity-getNotificationsCount-fetcher","flickr-activity-muteObject-updater","flickr-activity-unmuteObject-updater","attribute-helpers"]});YUI.add("flickr-account-getPrivileges-fetcher",(function(e,i){"use strict";e.namespace("ModelFetchers")["flickr-account-getPrivileges"]={run:function(r,s){var t=this;return e.FlickrPromise({apiResponse:s.callAPI("flickr.account.getPrivileges",r),privilegesRegistry:s.getModelRegistry("privileges-models")}).then((function(e){return t._processResponse(e,s,r)}),e.FetcherErrorLogger(i))},_processResponse:function(e,i,r){var s=e.apiResponse,t=e.privilegesRegistry,o={id:r.id,privileges:s.privileges,uploadLimits:s.uploadLimits};return t.add(o),t.proxy(r.id)}}}),"@VERSION@",{requires:["flickr-promise"],optional:["privileges-models","api-helper"]});YUI.add("privileges-models",(function(e){function i(e){i.superclass.constructor.call(this,e)}e.Models[this.name]=i,e.extend(i,e.FlickrModelRegistry,{name:this.name,remote:{read:function(i){return e.ModelFetchers["flickr-account-getPrivileges"].run(i,this.appContext)}},attributes:{id:{},privileges:{},uploadLimits:{}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-account-getPrivileges-fetcher"]});YUI.add("flickr-profile-getProfile-fetcher",(function(e,r){"use strict";e.namespace("ModelFetchers")["flickr-profile-getProfile"]={run:function(t,s){var o=this,i=s.getViewer();return i&&i.signedIn&&(t.id===i.nsid||t.nsid===i.nsid)&&(t.storage=1),new e.FlickrPromise({apiResponse:s.callAPI("flickr.profile.getProfile",this._processParams(t,s),!0),personPublicProfileModelRegistry:s.getModelRegistry("person-public-profile-models")}).then((function(e){return o._processResponse(e,t,s)}),e.FetcherErrorLogger(r))},_processParams:function(r,t){var s={datecreate:1};if(s.extras=e.APIHelper.request.getRebootPeopleExtras(),YUI.Env.isServer&&r.id===t.request.probableUser&&(s.storage=1,s.extras+=", classic_user_id, timezone_dst, unified_search_view_pref, photostream_view_order_pref, photostream_view_as_pref, album_view_layout, download_pref",s.extras+=", products_features",s.extras+=", is_minor"),r.extras&&"string"==typeof r.extras&&r.extras.length>0&&(s.extras=s.extras+","+r.extras),r.id)s.user_id=r.id;else{if(!r.pathAlias)throw new Error("`fetch` is missing required params.");s.path_alias=r.pathAlias}return r.storage&&(s.storage=r.storage),s.extras||(s.extras=""),s.extras+=", has_stats,expand_bbml,social_urls",r.hideStats||(s.extras+=",with_stats"),s},_processResponse:function(e,r,t){var s=e.apiResponse,o=e.personPublicProfileModelRegistry,i={};if(s&&s.profile){var a=s.profile,l=s.stats;return i={city:a.city,country:a.country,firstName:a.firstName,lastName:a.lastName,hometown:a.hometown,email:a.email,nsid:a.nsid,id:a.nsid,showcaseSetId:a.showcaseSet||"0",joinedDate:a.join_date,occupation:a.occupation,profileDescription:a.profileDescription,profileDescriptionExpanded:a.profileDescriptionExpanded,website:a.website,twitter:a.twitter,twitterUrl:a.twitterUrl,instagram:a.instagram,instagramUrl:a.instagramUrl,facebook:a.facebook,facebookUrl:a.facebookUrl,tumblr:a.tumblr,tumblrUrl:a.tumblrUrl,pinterest:a.pinterest,pinterestUrl:a.pinterestUrl,totalViews:l?l.photoViews:0,totalTags:l?l.tags:0,totalGeotagged:l?l.geotagged:0,totalFaves:l?l.faves:0,totalInGroup:l?l.groups:0},o.addOrUpdate(i)}}}}),"@VERSION@",{requires:["flickr-promise"],optional:["person-models","person-relationship-models","person-preferences-models","person-profile-models","person-public-profile-models","person-groups-models","photostream-models","api-helper"]});YUI.add("flickr-profile-setProfile-updater",(function(e,i){"use strict";e.namespace("ModelUpdaters")["flickr-profile-setProfile"]={run:function(s,l){var r=(function(e){var i={},s={profileDescription:"description",website:"website_url",firstName:"first_name",lastName:"last_name"};return e.fields.forEach((e=>{let l=s[e.name]||e.name;i[l]=e.value})),i.extras="full_response,expand_bbml,social_urls",i})(s);return new e.FlickrPromise({apiResponse:l.callAPI("flickr.profile.setProfile",r),personPublicProfileModel:l.getModel("person-public-profile-models",s.id)}).then(function(e){return(function(e,i,s,l){var r=e.apiResponse,t=e.personPublicProfileModel;if(r){var a={stat:r.stat,fields:[]},n=["instagram","facebook","tumblr","pinterest","twitter"];return Object.entries(r).forEach((([e,s])=>{"stat"!==e&&("description"===e?(a.fields.push({name:"profileDescription",value:s}),t.setValue("profileDescription",s),t.setValue("profileDescriptionExpanded",r.descriptionExpanded)):"website_url"===e?(a.fields.push({name:"website",value:s}),t.setValue("website",s)):"first_name"===e?(a.fields.push({name:"firstName",value:s}),t.setValue("firstName",s)):"last_name"===e?(a.fields.push({name:"lastName",value:s}),t.setValue("lastName",s)):n.indexOf(e)>-1?(a.fields.push({name:e,value:s}),t.setValue(e,s),t.setValue(e+"Url",r[e+"Url"])):void 0===s?(a.fields.push({name:e,value:i[e]}),t.setValue(e,i[e])):(a.fields.push({name:e,value:s}),t.setValue(e,s)))})),a}})(e,r)}.bind(this),e.FetcherErrorLogger(i))}}}),"@VERSION@",{requires:["flickr-promise"],optional:["person-public-profile-models"]});