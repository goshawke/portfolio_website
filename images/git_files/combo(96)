YUI.add("hermes-template-sub-photo-tagging-modal",(function(e,t){var a=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,t,a,l,n){var o=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,r=e.escapeExpression,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sub-photo-tagging-modal" tabindex="-1">\n\t'+r((i(a,"outlet")||t&&i(t,"outlet")||s).call(o,null!=t?i(t,"basic-closeable-header-view"):t,{name:"outlet",hash:{},data:n,loc:{start:{line:6,column:1},end:{line:6,column:39}}}))+'\n\t<div class="message-container">\n\t\t'+r((i(a,"outlet")||t&&i(t,"outlet")||s).call(o,null!=t?i(t,"tags-selection-list-view"):t,{name:"outlet",hash:{},data:n,loc:{start:{line:8,column:2},end:{line:8,column:37}}}))+"\n\t</div>\n</div>\n"},useData:!0}),l={};e.Array.each([],(function(t){var a=e.Template.get("hermes/"+t);a&&(l[t]=a)})),e.Template.register("hermes/sub-photo-tagging-modal",(function(t,n){return(n=n||{}).partials=n.partials?e.merge(l,n.partials):l,a(t,n)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("sub-photo-add-tags-view",(function(e,t){require("hermes-core/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.params=e,this.subviewConfig["basic-closeable-header-view"]=Object.assign(this.subviewConfig["basic-closeable-header-view"],{title:e.title,showCloseXButton:e.showCloseXButton,onClose:this.handleCloseClick.bind(this)}),this.subviewConfig["tags-selection-list-view"]=Object.assign(this.subviewConfig["tags-selection-list-view"],{selectionLists:e.selectionLists,onSelectionChanged:e.onSelectionChanged}),this.onSelectionChanged=void 0!==e.onSelectionChanged?e.onSelectionChanged:async e=>{},this.onConfirm=void 0!==e.onConfirm?e.onConfirm:async e=>{},this},subviewConfig:{"basic-closeable-header-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1},"tags-selection-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1}},loadState:function(){return this.appContext.getModel("photo-tags-models",this.params.photoId).then((e=>{this.set("photoTags",e)}))},buildContainer:function(){return this.setContainerWithTemplate("sub-photo-tagging-modal",this.params),this},activate:function(){var t=this.get("container"),i=t.one(".confirm-button"),s=t.one(".copy-tags"),o=t.one(".copy-success");return i&&this.registerEventHandler(i.on("click",this.handleConfirm.bind(this))),s&&(this.clipboard=new e.Clipboard(".copy-tags",{text:e=>{let t=this.get("photoTags").getValue("tags").getList();return 1===t.length?`"${t[0].getValue("tagRaw")}"`:t.map((e=>e.getValue("tagRaw"))).join(", ")}}),this.clipboard.on("success",(e=>{o.removeClass("invisible").setStyle("opacity",1),s.addClass("invisible").setStyle("opacity",0),this.clipboardAnimationFade=setTimeout((e=>{o.addClass("animated").setStyle("opacity",0),s.removeClass("invisible").addClass("animated").setStyle("opacity",1),this.clipboardAnimationCleanup=setTimeout((e=>{s.removeClass("animated"),o.addClass("invisible").removeClass("animated")}),333)}),1500)}))),this.registerEventHandler(t.on("keydown",this.handleKeyPress.bind(this))),this.registerEventHandler(t.delegate("focus",this.handleFocus.bind(this))),this},handleCloseClick:function(){this.fire("readyToClose")},handleConfirm:async function(){try{await this.onConfirm()}catch(e){return}},handleKeyPress:function(t){var i=t.keyCode,s=t.shiftKey,o=this.get("container"),n=o.one(".tags-selection-list-view"),a=o.one(".tags-selection-search"),l=n.one(".confirm-button");9===i&&(s&&this.focusedItem===a?(t.preventDefault(),l.focus()):s||this.focusedItem!==l||(t.preventDefault(),a.focus())),e.fire("subPhotoAddTags:keyPressed",{evt:t})},handleFocus:function(e){this.focusedItem=e.target},beforeDestroy:function(){clearTimeout(this.clipboardAnimationFade),clearTimeout(this.clipboardAnimationCleanup),this.clipboard&&this.clipboard.destroy()}})}),"@VERSION@",{requires:["flickr-view","hermes-template-sub-photo-tagging-modal"],optionalRequires:["clipboard"],langBundles:["common"]});YUI.add("clipboard",(function(t,e){
/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT Â© Zeno Rocha
 */
var n,r;n=this,r=function(){return(function(){var t={686:function(t,e,n){"use strict";n.d(e,{default:function(){return x}});var r=n(279),o=n.n(r),i=n(370),u=n.n(i),c=n(817),a=n.n(c);function f(t){try{return document.execCommand(t)}catch(t){return!1}}var l=function(t){var e=a()(t);return f("cut"),e},s=function(t,e){var n=(function(t){var e="rtl"===document.documentElement.getAttribute("dir"),n=document.createElement("textarea");n.style.fontSize="12pt",n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[e?"right":"left"]="-9999px";var r=window.pageYOffset||document.documentElement.scrollTop;return n.style.top="".concat(r,"px"),n.setAttribute("readonly",""),n.value=t,n})(t);e.container.appendChild(n);var r=a()(n);return f("copy"),n.remove(),r},d=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{container:document.body},n="";return"string"==typeof t?n=s(t,e):t instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(null==t?void 0:t.type)?n=s(t.value,e):(n=a()(t),f("copy")),n};function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}var y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.action,n=void 0===e?"copy":e,r=t.container,o=t.target,i=t.text;if("copy"!==n&&"cut"!==n)throw new Error('Invalid "action" value, use either "copy" or "cut"');if(void 0!==o){if(!o||"object"!==p(o)||1!==o.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===n&&o.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===n&&(o.hasAttribute("readonly")||o.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}return i?d(i,{container:r}):o?"cut"===n?l(o):d(o,{container:r}):void 0};function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e){return m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},m(t,e)}function b(t){var e=(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}})();return function(){var n,r=S(t);if(e){var o=S(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return g(this,n)}}function g(t,e){return!e||"object"!==v(e)&&"function"!=typeof e?(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t})(t):e}function S(t){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},S(t)}function E(t,e){var n="data-clipboard-".concat(t);if(e.hasAttribute(n))return e.getAttribute(n)}var w=(function(t){!(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)})(i,t);var e,n,r,o=b(i);function i(t,e){var n;return(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,i),(n=o.call(this)).resolveOptions(e),n.listenClick(t),n}return e=i,n=[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===v(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=u()(t,"click",(function(t){return e.onClick(t)}))}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget,n=this.action(e)||"copy",r=y({action:n,container:this.container,target:this.target(e),text:this.text(e)});this.emit(r?"success":"error",{action:n,text:r,trigger:e,clearSelection:function(){e&&e.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(t){return E("action",t)}},{key:"defaultTarget",value:function(t){var e=E("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return E("text",t)}},{key:"destroy",value:function(){this.listener.destroy()}}],r=[{key:"copy",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{container:document.body};return d(t,e)}},{key:"cut",value:function(t){return l(t)}},{key:"isSupported",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e="string"==typeof t?[t]:t,n=!!document.queryCommandSupported;return e.forEach((function(t){n=n&&!!document.queryCommandSupported(t)})),n}}],n&&h(e.prototype,n),r&&h(e,r),i})(o()),x=w},828:function(t){if("undefined"!=typeof Element&&!Element.prototype.matches){var e=Element.prototype;e.matches=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}t.exports=function(t,e){for(;t&&9!==t.nodeType;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}},438:function(t,e,n){var r=n(828);function o(t,e,n,r,o){var u=i.apply(this,arguments);return t.addEventListener(n,u,o),{destroy:function(){t.removeEventListener(n,u,o)}}}function i(t,e,n,o){return function(n){n.delegateTarget=r(n.target,e),n.delegateTarget&&o.call(t,n)}}t.exports=function(t,e,n,r,i){return"function"==typeof t.addEventListener?o.apply(null,arguments):"function"==typeof n?o.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,(function(t){return o(t,e,n,r,i)})))}},879:function(t,e){e.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},e.nodeList=function(t){var n=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in t&&(0===t.length||e.node(t[0]))},e.string=function(t){return"string"==typeof t||t instanceof String},e.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},370:function(t,e,n){var r=n(879),o=n(438);t.exports=function(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!r.string(e))throw new TypeError("Second argument must be a String");if(!r.fn(n))throw new TypeError("Third argument must be a Function");if(r.node(t))return(function(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}})(t,e,n);if(r.nodeList(t))return(function(t,e,n){return Array.prototype.forEach.call(t,(function(t){t.addEventListener(e,n)})),{destroy:function(){Array.prototype.forEach.call(t,(function(t){t.removeEventListener(e,n)}))}}})(t,e,n);if(r.string(t))return(function(t,e,n){return o(document.body,t,e,n)})(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},817:function(t){t.exports=function(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var n=t.hasAttribute("readonly");n||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),n||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var r=window.getSelection(),o=document.createRange();o.selectNodeContents(t),r.removeAllRanges(),r.addRange(o),e=r.toString()}return e}},279:function(t){function e(){}e.prototype={on:function(t,e,n){var r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var r=this;function o(){r.off(t,o),e.apply(n,arguments)}return o._=e,this.on(t,o,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),r=n[t],o=[];if(r&&e)for(var i=0,u=r.length;i<u;i++)r[i].fn!==e&&r[i].fn._!==e&&o.push(r[i]);return o.length?n[t]=o:delete n[t],this}},t.exports=e,t.exports.TinyEmitter=e}},e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}return n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n(686)})().default},"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.ClipboardJS=r():n.ClipboardJS=r(),t.Clipboard=this.ClipboardJS}),"@VERSION@",{affinity:"client"});YUI.add("hermes-template-sub-photo-tags-tag-section",(function(t,n){var l=t.Template.Handlebars.revive({1:function(t,n,l,a,e){var o,r=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return null!=(o=r(l,"if").call(null!=n?n:t.nullContext||{},null!=n?r(n,"tagsContainerIsEmpty"):n,{name:"if",hash:{},fn:t.program(2,e,0),inverse:t.program(4,e,0),data:e,loc:{start:{line:2,column:1},end:{line:6,column:8}}}))?o:""},2:function(t,n,l,a,e){var o=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t\t<a href="#" class="show-add-tags">'+t.escapeExpression((o(l,"intlMessage")||n&&o(n,"intlMessage")||t.hooks.helperMissing).call(null!=n?n:t.nullContext||{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADD_TAGS"},data:e,loc:{start:{line:3,column:36},end:{line:3,column:90}}}))+"</a>\n"},4:function(t,n,l,a,e){var o=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t\t<a href="#" class="show-add-tags">'+t.escapeExpression((o(l,"intlMessage")||n&&o(n,"intlMessage")||t.hooks.helperMissing).call(null!=n?n:t.nullContext||{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.EDIT_TAGS"},data:e,loc:{start:{line:5,column:36},end:{line:5,column:91}}}))+"</a>\n"},6:function(t,n,l,a,e){var o,r=null!=n?n:t.nullContext||{},u=t.hooks.helperMissing,i=t.escapeExpression,s=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t<a class="tag-section-header" href="'+i("function"==typeof(o=null!=(o=s(l,"tagPageURL")||(null!=n?s(n,"tagPageURL"):n))?o:u)?o.call(r,{name:"tagPageURL",hash:{},data:e,loc:{start:{line:10,column:37},end:{line:10,column:51}}}):o)+'">'+i((s(l,"intlMessage")||n&&s(n,"intlMessage")||u).call(r,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.TAGS"},data:e,loc:{start:{line:10,column:53},end:{line:10,column:103}}}))+"</a>\n"},8:function(t,n,l,a,e){var o=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t<h3 class="tag-section-header">'+t.escapeExpression((o(l,"intlMessage")||n&&o(n,"intlMessage")||t.hooks.helperMissing).call(null!=n?n:t.nullContext||{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.TAGS"},data:e,loc:{start:{line:12,column:32},end:{line:12,column:82}}}))+"</h3>\n"},10:function(t,n,l,a,e){var o=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t\t\t<input type="text" class= "add-tag" placeholder="'+t.escapeExpression((o(l,"intlMessage")||n&&o(n,"intlMessage")||t.hooks.helperMissing).call(null!=n?n:t.nullContext||{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADD_A_TAG"},data:e,loc:{start:{line:18,column:52},end:{line:18,column:107}}}))+'">\n'},12:function(t,n,l,a,e){var o,r,u=null!=n?n:t.nullContext||{},i=t.hooks.helperMissing,s="function",c=t.escapeExpression,p=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t\t\t<li data-author="'+c(typeof(r=null!=(r=p(l,"tagAuthorNSID")||(null!=n?p(n,"tagAuthorNSID"):n))?r:i)===s?r.call(u,{name:"tagAuthorNSID",hash:{},data:e,loc:{start:{line:21,column:20},end:{line:21,column:37}}}):r)+'" data-tag-id="'+c(typeof(r=null!=(r=p(l,"id")||(null!=n?p(n,"id"):n))?r:i)===s?r.call(u,{name:"id",hash:{},data:e,loc:{start:{line:21,column:52},end:{line:21,column:58}}}):r)+'" class="tag" '+(null!=(o=p(l,"if").call(u,(o=e&&p(e,"root"))&&p(o,"autotagsEnabled"),{name:"if",hash:{},fn:t.program(13,e,0),inverse:t.noop,data:e,loc:{start:{line:21,column:72},end:{line:21,column:181}}}))?o:"")+' data-track="tagClick">\n\t\t\t\t<a class="'+(null!=(o=p(l,"if").call(u,(o=e&&p(e,"root"))&&p(o,"autotagsEnabled"),{name:"if",hash:{},fn:t.program(16,e,0),inverse:t.program(19,e,0),data:e,loc:{start:{line:22,column:14},end:{line:22,column:134}}}))?o:"")+'" href="#">\n\t\t\t\t\t<i class="'+(null!=(o=p(l,"if").call(u,(o=e&&p(e,"root"))&&p(o,"autotagsEnabled"),{name:"if",hash:{},fn:t.program(21,e,0),inverse:t.program(24,e,0),data:e,loc:{start:{line:23,column:15},end:{line:23,column:135}}}))?o:"")+'" title="'+c((p(l,"intlMessage")||n&&p(n,"intlMessage")||i).call(u,{name:"intlMessage",hash:{intlName:"common.DELETE"},data:e,loc:{start:{line:23,column:144},end:{line:23,column:184}}}))+'"></i>\n\t\t\t\t</a>\n\t\t\t\t<a href="'+(null!=(o=p(l,"if").call(u,(o=e&&p(e,"root"))&&p(o,"linkTagToTagsPage"),{name:"if",hash:{},fn:t.program(26,e,0),inverse:t.program(28,e,0),data:e,loc:{start:{line:25,column:13},end:{line:25,column:79}}}))?o:"")+'" title="'+c(typeof(r=null!=(r=p(l,"tagRaw")||(null!=n?p(n,"tagRaw"):n))?r:i)===s?r.call(u,{name:"tagRaw",hash:{},data:e,loc:{start:{line:25,column:88},end:{line:25,column:98}}}):r)+'" class="tag-text">'+c(typeof(r=null!=(r=p(l,"tagRaw")||(null!=n?p(n,"tagRaw"):n))?r:i)===s?r.call(u,{name:"tagRaw",hash:{},data:e,loc:{start:{line:25,column:117},end:{line:25,column:127}}}):r)+"</a>\n\t\t\t</li>\n"},13:function(t,n,l,a,e){var o,r=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return null!=(o=r(l,"if").call(null!=n?n:t.nullContext||{},null!=n?r(n,"duplicateAutotagId"):n,{name:"if",hash:{},fn:t.program(14,e,0),inverse:t.noop,data:e,loc:{start:{line:21,column:101},end:{line:21,column:174}}}))?o:""},14:function(t,n,l,a,e){var o,r=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'data-autotag-id="'+t.escapeExpression("function"==typeof(o=null!=(o=r(l,"duplicateAutotagId")||(null!=n?r(n,"duplicateAutotagId"):n))?o:t.hooks.helperMissing)?o.call(null!=n?n:t.nullContext||{},{name:"duplicateAutotagId",hash:{},data:e,loc:{start:{line:21,column:144},end:{line:21,column:166}}}):o)+'"'},16:function(t,n,l,a,e){var o,r=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return null!=(o=r(l,"if").call(null!=n?n:t.nullContext||{},null!=n?r(n,"duplicateAutotagId"):n,{name:"if",hash:{},fn:t.program(17,e,0),inverse:t.program(19,e,0),data:e,loc:{start:{line:22,column:43},end:{line:22,column:109}}}))?o:""},17:function(t,n,l,a,e){return"remove-dual-tag"},19:function(t,n,l,a,e){return"remove-tag"},21:function(t,n,l,a,e){var o,r=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return null!=(o=r(l,"if").call(null!=n?n:t.nullContext||{},null!=n?r(n,"duplicateAutotagId"):n,{name:"if",hash:{},fn:t.program(22,e,0),inverse:t.program(24,e,0),data:e,loc:{start:{line:23,column:44},end:{line:23,column:110}}}))?o:""},22:function(t,n,l,a,e){return"delete-dual-tag"},24:function(t,n,l,a,e){return"delete-tag"},26:function(t,n,l,a,e){var o,r=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return t.escapeExpression("function"==typeof(o=null!=(o=r(l,"url")||(null!=n?r(n,"url"):n))?o:t.hooks.helperMissing)?o.call(null!=n?n:t.nullContext||{},{name:"url",hash:{},data:e,loc:{start:{line:25,column:44},end:{line:25,column:51}}}):o)},28:function(t,n,l,a,e){var o,r=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return t.escapeExpression("function"==typeof(o=null!=(o=r(l,"searchUrl")||(null!=n?r(n,"searchUrl"):n))?o:t.hooks.helperMissing)?o.call(null!=n?n:t.nullContext||{},{name:"searchUrl",hash:{},data:e,loc:{start:{line:25,column:59},end:{line:25,column:72}}}):o)},30:function(t,n,l,a,e){var o,r=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return null!=(o=r(l,"each").call(null!=n?n:t.nullContext||{},null!=n?r(n,"autotags"):n,{name:"each",hash:{},fn:t.program(31,e,0),inverse:t.noop,data:e,loc:{start:{line:29,column:3},end:{line:43,column:12}}}))?o:""},31:function(t,n,l,a,e){var o,r,u=null!=n?n:t.nullContext||{},i=t.hooks.helperMissing,s="function",c=t.escapeExpression,p=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t\t\t\t<li class="autotag '+(null!=(o=p(l,"if").call(u,null!=n?p(n,"isPrivate"):n,{name:"if",hash:{},fn:t.program(32,e,0),inverse:t.noop,data:e,loc:{start:{line:30,column:23},end:{line:30,column:54}}}))?o:"")+" "+(null!=(o=p(l,"if").call(u,(o=e&&p(e,"root"))&&p(o,"viewerIsOwner"),{name:"if",hash:{},fn:t.program(34,e,0),inverse:t.noop,data:e,loc:{start:{line:30,column:55},end:{line:30,column:103}}}))?o:"")+'" data-autotag-content="'+c(typeof(r=null!=(r=p(l,"autotagValue")||(null!=n?p(n,"autotagValue"):n))?r:i)===s?r.call(u,{name:"autotagValue",hash:{},data:e,loc:{start:{line:30,column:127},end:{line:30,column:143}}}):r)+'" data-autotag-id="'+c(typeof(r=null!=(r=p(l,"id")||(null!=n?p(n,"id"):n))?r:i)===s?r.call(u,{name:"id",hash:{},data:e,loc:{start:{line:30,column:162},end:{line:30,column:168}}}):r)+'" data-track="autotagClick">\n'+(null!=(o=p(l,"if").call(u,(o=e&&p(e,"root"))&&p(o,"viewerIsOwner"),{name:"if",hash:{},fn:t.program(36,e,0),inverse:t.noop,data:e,loc:{start:{line:31,column:5},end:{line:35,column:12}}}))?o:"")+(null!=(o=p(l,"if").call(u,null!=n?p(n,"isPrivate"):n,{name:"if",hash:{},fn:t.program(38,e,0),inverse:t.noop,data:e,loc:{start:{line:36,column:5},end:{line:40,column:12}}}))?o:"")+'\t\t\t\t\t<a href="'+(null!=(o=p(l,"if").call(u,(o=e&&p(e,"root"))&&p(o,"linkTagToTagsPage"),{name:"if",hash:{},fn:t.program(40,e,0),inverse:t.program(28,e,0),data:e,loc:{start:{line:41,column:14},end:{line:41,column:109}}}))?o:"")+'" title="'+c(typeof(r=null!=(r=p(l,"autotagValue")||(null!=n?p(n,"autotagValue"):n))?r:i)===s?r.call(u,{name:"autotagValue",hash:{},data:e,loc:{start:{line:41,column:118},end:{line:41,column:134}}}):r)+'" class="tag-text">'+c(typeof(r=null!=(r=p(l,"autotagValue")||(null!=n?p(n,"autotagValue"):n))?r:i)===s?r.call(u,{name:"autotagValue",hash:{},data:e,loc:{start:{line:41,column:153},end:{line:41,column:169}}}):r)+"</a>\n\t\t\t\t</li>\n"},32:function(t,n,l,a,e){return"private"},34:function(t,n,l,a,e){return"can-remove-tag"},36:function(t,n,l,a,e){var o=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t\t\t\t\t\t<span class="remove-autotag">\n\t\t\t\t\t\t\t<i class="delete-autotag" title="'+t.escapeExpression((o(l,"intlMessage")||n&&o(n,"intlMessage")||t.hooks.helperMissing).call(null!=n?n:t.nullContext||{},{name:"intlMessage",hash:{intlName:"common.DELETE"},data:e,loc:{start:{line:33,column:40},end:{line:33,column:80}}}))+'"></i>\n\t\t\t\t\t\t</span>\n'},38:function(t,n,l,a,e){var o,r=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t\t\t\t\t\t<span class="private-autotag">\n\t\t\t\t\t\t\t<i class="private-autotag-icon" title="'+t.escapeExpression(t.lambda((o=e&&r(e,"root"))&&r(o,"privateAutotagHelperText"),n))+'"></i>\n\t\t\t\t\t\t</span>\n'},40:function(t,n,l,a,e){var o,r,u=t.escapeExpression,i=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return u(t.lambda((o=e&&i(e,"root"))&&i(o,"tagPageURL"),n))+u("function"==typeof(r=null!=(r=i(l,"autotagValue")||(null!=n?i(n,"autotagValue"):n))?r:t.hooks.helperMissing)?r.call(null!=n?n:t.nullContext||{},{name:"autotagValue",hash:{},data:e,loc:{start:{line:41,column:65},end:{line:41,column:81}}}):r)},42:function(t,n,l,a,e){var o,r,u=null!=n?n:t.nullContext||{},i=t.hooks.helperMissing,s="function",c=t.escapeExpression,p=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t\t\t\t<li data-author="'+c(typeof(r=null!=(r=p(l,"tagAuthorNSID")||(null!=n?p(n,"tagAuthorNSID"):n))?r:i)===s?r.call(u,{name:"tagAuthorNSID",hash:{},data:e,loc:{start:{line:50,column:21},end:{line:50,column:38}}}):r)+'" data-tag-id="'+c(typeof(r=null!=(r=p(l,"id")||(null!=n?p(n,"id"):n))?r:i)===s?r.call(u,{name:"id",hash:{},data:e,loc:{start:{line:50,column:53},end:{line:50,column:59}}}):r)+'" class="tag" data-track="tagClick">\n\t\t\t\t\t<a class="remove-tag" href="#">\n\t\t\t\t\t\t<i class="delete-tag" title="'+c((p(l,"intlMessage")||n&&p(n,"intlMessage")||i).call(u,{name:"intlMessage",hash:{intlName:"common.DELETE"},data:e,loc:{start:{line:52,column:35},end:{line:52,column:75}}}))+'"></i>\n\t\t\t\t\t</a>\n\t\t\t\t\t<a href="'+(null!=(o=p(l,"if").call(u,(o=e&&p(e,"root"))&&p(o,"linkTagToTagsPage"),{name:"if",hash:{},fn:t.program(26,e,0),inverse:t.program(28,e,0),data:e,loc:{start:{line:54,column:14},end:{line:54,column:80}}}))?o:"")+'" title="'+c(typeof(r=null!=(r=p(l,"tagRaw")||(null!=n?p(n,"tagRaw"):n))?r:i)===s?r.call(u,{name:"tagRaw",hash:{},data:e,loc:{start:{line:54,column:89},end:{line:54,column:99}}}):r)+'" class="tag-text">'+c(typeof(r=null!=(r=p(l,"tagRaw")||(null!=n?p(n,"tagRaw"):n))?r:i)===s?r.call(u,{name:"tagRaw",hash:{},data:e,loc:{start:{line:54,column:118},end:{line:54,column:128}}}):r)+"</a>\n\t\t\t\t</li>\n"},compiler:[8,">= 4.3.0"],main:function(t,n,l,a,e){var o,r=null!=n?n:t.nullContext||{},u=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return(null!=(o=u(l,"if").call(r,null!=n?u(n,"canEditTags"):n,{name:"if",hash:{},fn:t.program(1,e,0),inverse:t.noop,data:e,loc:{start:{line:1,column:0},end:{line:7,column:7}}}))?o:"")+"\n"+(null!=(o=u(l,"if").call(r,null!=n?u(n,"linkTagToTagsPage"):n,{name:"if",hash:{},fn:t.program(6,e,0),inverse:t.program(8,e,0),data:e,loc:{start:{line:9,column:0},end:{line:13,column:7}}}))?o:"")+'\n<div class="tags-list-container">\n\t<ul class="tags-list">\n'+(null!=(o=u(l,"if").call(r,null!=n?u(n,"canAddMeta"):n,{name:"if",hash:{},fn:t.program(10,e,0),inverse:t.noop,data:e,loc:{start:{line:17,column:2},end:{line:19,column:9}}}))?o:"")+(null!=(o=u(l,"each").call(r,null!=n?u(n,"tags"):n,{name:"each",hash:{},fn:t.program(12,e,0),inverse:t.noop,data:e,loc:{start:{line:20,column:2},end:{line:27,column:11}}}))?o:"")+(null!=(o=u(l,"if").call(r,null!=n?u(n,"autotagsEnabled"):n,{name:"if",hash:{},fn:t.program(30,e,0),inverse:t.noop,data:e,loc:{start:{line:28,column:2},end:{line:44,column:9}}}))?o:"")+'\t</ul>\n\n\t<div class="machine-tags-section">\n\t\t<ul class="machine-tags-list">\n'+(null!=(o=u(l,"each").call(r,null!=n?u(n,"machineTags"):n,{name:"each",hash:{},fn:t.program(42,e,0),inverse:t.noop,data:e,loc:{start:{line:49,column:3},end:{line:56,column:12}}}))?o:"")+"\t\t</ul>\n\t</div>\n</div>\n"},useData:!0}),a={};t.Array.each([],(function(n){var l=t.Template.get("hermes/"+n);l&&(a[n]=l)})),t.Template.register("hermes/sub-photo-tags-tag-section",(function(n,e){return(e=e||{}).partials=e.partials?t.merge(a,e.partials):a,l(n,e)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-sub-photo-tags-tag",(function(a,e){var l=a.Template.Handlebars.revive({1:function(a,e,l,t,n){return"can-remove-tag deselected"},3:function(a,e,l,t,n){var o,r=a.lookupProperty||function(a,e){if(Object.prototype.hasOwnProperty.call(a,e))return a[e]};return null!=(o=(r(l,"canRemoveTag")||e&&r(e,"canRemoveTag")||a.hooks.helperMissing).call(null!=e?e:a.nullContext||{},null!=e?r(e,"tagAuthorNSID"):e,(o=n&&r(n,"root"))&&r(o,"viewerNSID"),(o=n&&r(n,"root"))&&r(o,"isOwner"),{name:"canRemoveTag",hash:{},fn:a.program(4,n,0),inverse:a.noop,data:n,loc:{start:{line:1,column:235},end:{line:1,column:328}}}))?o:""},4:function(a,e,l,t,n){return"can-remove-tag"},compiler:[8,">= 4.3.0"],main:function(a,e,l,t,n){var o,r,c=null!=e?e:a.nullContext||{},i=a.hooks.helperMissing,s="function",u=a.escapeExpression,m=a.lookupProperty||function(a,e){if(Object.prototype.hasOwnProperty.call(a,e))return a[e]};return'<li data-value="'+u(typeof(r=null!=(r=m(l,"tagValue")||(null!=e?m(e,"tagValue"):e))?r:i)===s?r.call(c,{name:"tagValue",hash:{},data:n,loc:{start:{line:1,column:16},end:{line:1,column:28}}}):r)+'" data-search-value="'+u((m(l,"convertToSearchText")||e&&m(e,"convertToSearchText")||i).call(c,null!=e?m(e,"tagValue"):e,{name:"convertToSearchText",hash:{},data:n,loc:{start:{line:1,column:49},end:{line:1,column:81}}}))+'" data-raw="'+u(typeof(r=null!=(r=m(l,"tagRaw")||(null!=e?m(e,"tagRaw"):e))?r:i)===s?r.call(c,{name:"tagRaw",hash:{},data:n,loc:{start:{line:1,column:93},end:{line:1,column:103}}}):r)+'" data-author="'+u(typeof(r=null!=(r=m(l,"tagAuthorNSID")||(null!=e?m(e,"tagAuthorNSID"):e))?r:i)===s?r.call(c,{name:"tagAuthorNSID",hash:{},data:n,loc:{start:{line:1,column:118},end:{line:1,column:135}}}):r)+'" data-tag-id="'+u(typeof(r=null!=(r=m(l,"id")||(null!=e?m(e,"id"):e))?r:i)===s?r.call(c,{name:"id",hash:{},data:n,loc:{start:{line:1,column:150},end:{line:1,column:156}}}):r)+'" class="tag remove-tag '+(null!=(o=m(l,"if").call(c,null!=e?m(e,"isSuggestedTag"):e,{name:"if",hash:{},fn:a.program(1,n,0),inverse:a.program(3,n,0),data:n,loc:{start:{line:1,column:180},end:{line:1,column:335}}}))?o:"")+'" data-track="tagClick">\n\t<div class="tag-content-container">\n\t\t<div class="tag-content">\n\t\t\t<svg class="icon-tag"><use xlink:href="#icon-tag"></use></svg>\n\t\t\t<p>'+u(typeof(r=null!=(r=m(l,"tagRaw")||(null!=e?m(e,"tagRaw"):e))?r:i)===s?r.call(c,{name:"tagRaw",hash:{},data:n,loc:{start:{line:5,column:6},end:{line:5,column:16}}}):r)+'</p>\n\t\t</div>\n\t\t<svg class="icon icon-check_circle '+(null!=(o=(m(l,"canRemoveTag")||e&&m(e,"canRemoveTag")||i).call(c,null!=e?m(e,"tagAuthorNSID"):e,(o=n&&m(n,"root"))&&m(o,"viewerNSID"),(o=n&&m(n,"root"))&&m(o,"isOwner"),{name:"canRemoveTag",hash:{},fn:a.program(4,n,0),inverse:a.noop,data:n,loc:{start:{line:7,column:37},end:{line:7,column:130}}}))?o:"")+'"><use xlink:href="#icon-check_circle"></use></svg>\n'+(null!=(o=a.invokePartial(m(t,"flickr-balls"),e,{name:"flickr-balls",data:n,indent:"\t\t",helpers:l,partials:t,decorators:a.decorators}))?o:"")+"\t</div>\n</li>\n"},usePartial:!0,useData:!0}),t={};a.Array.each(["flickr-balls"],(function(e){var l=a.Template.get("hermes/"+e);l&&(t[e]=l)})),a.Template.register("hermes/sub-photo-tags-tag",(function(e,n){return(n=n||{}).partials=n.partials?a.merge(t,n.partials):t,l(e,n)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-flickr-balls"]});YUI.add("hermes-template-tags-helper-text",(function(e,a){var t=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,t,l,n){var s=null!=a?a:e.nullContext||{},r=e.hooks.helperMissing,i=e.escapeExpression,o=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<div class="tags-helper-text">\n\t'+i((o(t,"intlMessage")||a&&o(a,"intlMessage")||r).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.TAGS_HELP_TEXT"},data:n,loc:{start:{line:2,column:1},end:{line:2,column:61}}}))+'\n</div>\n<a href="https://flickrhelp.com/hc/en-us/articles/4404058631700-Tag-keywords-in-Flickr" target="_blank">'+i((o(t,"intlMessage")||a&&o(a,"intlMessage")||r).call(s,{name:"intlMessage",hash:{intlName:"common.LEARN_MORE"},data:n,loc:{start:{line:4,column:104},end:{line:4,column:148}}}))+"</a>\n"},useData:!0}),l={};e.Array.each([],(function(a){var t=e.Template.get("hermes/"+a);t&&(l[a]=t)})),e.Template.register("hermes/tags-helper-text",(function(a,n){return(n=n||{}).partials=n.partials?e.merge(l,n.partials):l,t(a,n)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("tag-helper",(function(e,r){e.TagHelper=class{static parse(e=""){var r;return(r=e.replace(/["â](.*?)["â]/g,((e,r)=>r=(r=r.replace(/(,)/g,((e,r)=>"{COMMA}"))).replace(/(\s)/g,((e,r)=>`{WHITESPACE-${r.charCodeAt(0)}}`))))).split(r.includes(",")?/,/:/\s+/).map(((e,r)=>e=(e=(e=e.replace(/\{WHITESPACE-(\d+)\}/g,((e,r)=>String.fromCharCode(r)))).replace(/\{COMMA\}/g,((e,r)=>","))).trim())).filter((e=>e.length>0))}static dedupe(e=[]){var r=new Map(e.reverse().map((e=>[this.clean(e),e])));return Array.from(r.values()).reverse()}static clean(e=""){return e.replace(/[\s!-\/:-@[-`]/g,"").toLowerCase()}}}),"@VERSION@",{requires:[],optionalRequires:[]});YUI.add("sub-photo-tags-tag-view",(function(t,e){var s=require("hermes-core/flog")(e);t.FlickrView.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.photoId=e.photoId,this.context=t.clone(e.context,!0),this.nsid=e.nsid,this.pathAlias=e.pathAlias,this.isMobileTags=e.isMobileTags||!1,this.savedTags=[],""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},loadState:function(){var e=this,s=this.appContext.getViewer(),a=[];return a.push(new t.FlickrPromise({photo:e.appContext.getModel("photo-models",e.photoId),photoTags:e.appContext.getModel("photo-tags-models",this.photoId),tagModel:e.appContext.getModelRegistry("tag-models"),photoAutotags:e.appContext.getModel("photo-autotags-models",e.photoId),autotagModel:e.appContext.getModelRegistry("autotag-models")}).then((t=>{e.set("photo",t.photo),e.set("photoTags",t.photoTags),e.set("tagModel",t.tagModel),e.set("photoAutotags",t.photoAutotags),e.set("autotagModel",t.autotagModel)}))),s.signedIn&&a.push(new t.FlickrPromise({userTags:e.appContext.getModel("user-tags-models",s.nsid),userTagModel:e.appContext.getModelRegistry("user-tag-models"),popularUserTags:e.appContext.callAPI("flickr.tags.getListUserPopular",{count:25,extras:"include_raw"})}).then((t=>{e.set("userTags",t.userTags),e.set("userTagModel",t.userTagModel),e.set("popularUserTags",t.popularUserTags)}))),t.Promise.all(a)},buildContainer:function(){var t,e=this.get("photo"),s=this.get("photoTags").getValue("tags"),a=this.get("popularUserTags"),o=e.getValue("isOwner")||e.getValue("canAddMeta"),i=/^[a-zA-Z]\w*:[a-zA-Z]\w*=.+/,g=[],n=[],r=!1,h=!1,l=!1,p=this.get("photoAutotags").getValue("autotags"),u=e.getValue("isOwner"),d=!1,c=!this.isMobileTags,T=this.appContext.getViewer(),m={tag:[],additionalListClass:"tags-list"},w={tag:[]},M={tag:[],additionalListClass:"machine-tags-list"},A={tag:[]},V={tag:[],additionalListClass:"suggested-tags-list"},v=!1;if(s&&0!==(s=s.toJSON()).length)for(r=!0,t=0;t<s.length;t++)T.nsid===s[t].tagAuthorNSID&&(v=!0),i.test(s[t].tagRaw)?(T.nsid===s[t].tagAuthorNSID||u?M.tag.push(s[t]):A.tag.push(s[t]),g.push(s[t])):(T.nsid===s[t].tagAuthorNSID||u?m.tag.push(s[t]):w.tag.push(s[t]),n.push(s[t]));a&&o&&a.who.tags.tag.forEach((t=>{s.some((e=>e.tagValue===t.content))||V.tag.push({id:t.content,tagValue:t.content,tagRaw:t.raw[0],isSuggestedTag:!0})})),p&&0!==(p=p.toJSON()).length&&(h=!0,d=u?this.intlMessage({intlName:"photo-page-scrappy.PRIVATE_TAGS_OWNER_HELPER_TEXT"}):this.intlMessage({intlName:"photo-page-scrappy.PRIVATE_TAGS_FRIENDS_FAMILY_HELPER_TEXT"})),r||h||(l=!0),l&&o?(this.get("container").addClass("empty"),this.fire("subviewViewEvent","tagsTagView:tagsEmpty")):this.get("container").hasClass("empty")&&this.get("container").removeClass("empty");var C=e.getValue("isOwner")||e.getValue("canAddMeta");return this.templateConfig={tags:n,machineTags:g,autotags:p,viewerIsOwner:u,privateAutotagHelperText:d,canAddMeta:C,viewerNSID:this.appContext.getViewer().nsid,isOwner:e.getValue("isOwner"),autotagsEnabled:!0,showTagInfoBlock:c,linkTagToTagsPage:!0,tagPageURL:"/photos/tags/",tagsContainerIsEmpty:l,canEditTags:C||v},this.selectionLists={removableRegularTags:m,removableMachineTags:M,nonRemovableRegularTags:w,nonRemovableMachineTags:A,suggestedUserTags:V},o||!l?this.setContainerWithTemplate("sub-photo-tags-tag-section",this.templateConfig):this.get("container").setHTML(""),this},activate:function(){var e,s=this.get("photo"),a=this.get("container"),o=s.getValue("owner")||s.getValue("canAddMeta"),i=this.get("photoTags").getValue("tags"),g=/^[a-zA-Z]\w*:[a-zA-Z]\w*=.+/,n=[];for(i&&(i=i.toJSON()),0===i.length&&this.fire("subviewViewEvent","noTags"),this.fire("subviewViewEvent","tagsLoaded",i),e=0;e<i.length;e++)g.test(i[e].tagRaw)&&n.push(i[e]);return n.length&&a.one(".machine-tags-section")&&a.one(".machine-tags-section").setStyle("display","block"),!this.isMobileTags&&o&&a.one(".show-add-tags")&&(a.one(".show-add-tags").on("click",(e=>{e.preventDefault(),this.showAddTagsModal(),t.Snowplough.sendStructuredEvent({category:"photopageinteractions",action:"addTagClick"},t.Snowplough.getPhotoContextFromModel(this.get("photo")))})),this.attachKeyEvent("down:84",(t=>{t.preventDefault();try{this.showAddTagsModal()}catch(t){}}))),this.registerEventHandler(a.delegate("click",(e=>{t.Snowplough.sendStructuredEvent({category:"photopageinteractions",action:"tagClick",label:e.currentTarget.one(".tag-text").getDOMNode().text},t.Snowplough.getPhotoContextFromModel(this.get("photo")))}),".tag")),this},_whichTagList:function(t){var e=/^[a-zA-Z]\w*:[a-zA-Z]\w*=.+/,s=t||this.get("container"),a=[s.one(".machine-tags-list"),s.one(".tags-list")];return function(t){return e.test(t)?a[0]:a[1]}},onError:function(e){return this.errorDialog=new t.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showCancelButton:!1,title:this.intlMessage({intlName:"common.OOPS"}),actionButtonLabel:this.intlMessage({intlName:"common.OK"}),htmlMessage:e}),this.errorDialog.show(),this.errorDialog},showAddTagsModal:function(){let e,s=this.get("photo"),a=s.getValue("isOwner")||s.getValue("canAddMeta"),o=new t.Views["sub-photo-add-tags-view"]({title:this.intlMessage({intlName:"photo-page-scrappy.ADD_TAGS"}),showCloseXButton:!0,viewerNSID:this.appContext.getViewer().nsid,photoId:this.photoId,isOwner:s.getValue("isOwner"),placeholderText:this.intlMessage({intlName:"photo-page-scrappy.SEPARATE_TAGS_WITH_SPACE"}),url:"/photos/me/tags",urlText:this.intlMessage({intlName:"photo-page-scrappy.MANAGE_TAGS"}),emptyMessage:this.intlMessage({intlName:"photo-page-scrappy.PRESS_ENTER_ADD_TAGS"}),emptyTip:this.intlMessage({intlName:"photo-page-scrappy.TAG_TIP"}),canAddMeta:a,disabledSearchPlaceholder:s.getValue("isVideo")?this.intlMessage({intlName:"photo-page-scrappy.YOU_CANNOT_ADD_TAGS_VIDEO"}):this.intlMessage({intlName:"photo-page-scrappy.YOU_CANNOT_ADD_TAGS_PHOTO"}),tagCount:this.get("photoTags").getValue("tags").toJSON().length,tagLimit:t.config.flickr.api.max_tags_in_photo,onConfirm:async()=>{e.close()},loadTags:()=>a?this.get("userTags").getValue("isDataStale")?t.Promise.resolve(this.refreshUserTags().then((()=>(this.userTags=this.get("userTags").getValue("tags").toJSON(),this.selectionLists)))):(this.userTags=this.get("userTags").getValue("tags").toJSON(),t.Promise.resolve(this.selectionLists)):t.Promise.resolve(this.selectionLists),addTag:e=>{var s=this,a=this.get("tagModel"),o=this.get("userTagModel"),i=this.get("userTags").getValue("tags");return t.Promise.resolve(a.remoteCreate({photoId:[s.photoId],tags:[e.tagValue]}).then((t=>(t.forEach((t=>{var s=t.getValue("tagRaw"),a=t.getValue("tagValue"),g=e.container.one("[data-value='"+a+"']");if(g)g.setAttribute("data-tag-id",t.getValue("id")),g.setAttribute("data-author",this.appContext.getViewer().nsid),g.hasClass("deselected")&&g.removeClass("deselected");else{var n=o.addOrUpdate({id:a,tagValue:a,tagRaw:s,isSuggestedTag:!0});i.prependToList(n);var r,h,l,p=this._whichTagList(e.container)(s),u=p.hasClass("machine-tags-list"),d={tagValue:a,id:t.getValue("id"),tagAuthorNSID:this.appContext.getViewer().nsid,tagRaw:s,viewerNSID:this.appContext.getViewer().nsid};u?(s.indexOf(" ")>0?(h=s.indexOf("=")+1,l=s.substring(0,h)+'"'+t.substring(h)+'"',d.tagValue=l):d.tagValue=s,r=this.templates("sub-photo-tags-tag")(d),p.prepend(r)):(r=this.templates("sub-photo-tags-tag")(d),p.prepend(r))}})),t)),(t=>{throw 2===t.code?s.onError(s.intlMessage({intlName:"photo-page-scrappy.MAX_TAG_LIMIT"})):s.onError(s.intlMessage({intlName:"photo-page-scrappy.ERROR_ADDING_TAG"})),t})))},removeTag:e=>{var s=this.get("tagModel"),a=this.get("photoTags").getValue("tags");return t.Promise.resolve(s.remoteDelete(e).then((()=>{a.removeFromList(e,"id"),this.get("userTags").setValue("isDataStale",!0)}),(()=>{this.onError(this.intlMessage({intlName:"photo-page-scrappy.ERROR_DELETING_TAG"}))})))},getTagList:(t,e)=>this._whichTagList(e)(t),getSearchResults:(t,e)=>{var s=[],a=0;for(const o of this.userTags)if(o.tagValue.indexOf(t)>-1&&(s.push(o),a++),a>=e)break;return s}});e=new t.Views.FluidModal({appContext:this.appContext,subview:o,hasSubviewConfigRefactor:!0,flexLayout:!0,height:450}).show(),e.on("close",(()=>{this.detachRegisteredEvents(),this.buildContainer(),this.activate()}))},refreshUserTags:function(){return t.Promise.resolve(this.appContext.getModelRegistry("user-tags-models").then((t=>(t.remove(this.appContext.getViewer().nsid),t.get(this.appContext.getViewer().nsid)))).then((t=>{this.set("userTags",t)})).catch((t=>{s.error("Error refreshing user tags: ",t)})))}})}),"@VERSION@",{requires:["flickr-view","sub-photo-add-tags-view","hermes-template-sub-photo-tags-tag-section","hermes-template-sub-photo-tags-tag","hermes-template-tags-helper-text","hermes-template-head-meta","url-helper","tag-helper"],optionalRequires:["hermes-core"],optional:[],langBundles:["common","photo-page-scrappy"]});