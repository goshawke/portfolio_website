YUI.add("flickr-account-changeFirstAndLastName-updater",(function(e,a){"use strict";e.namespace("ModelUpdaters")["flickr-account-changeFirstAndLastName"]={run:function(r,n){var i=(function(e){return{first_name:e.firstName,last_name:e.lastName}})(r);return new e.FlickrPromise({apiResponse:n.callAPI("flickr.account.changeFirstAndLastName",i),publicProfileModel:n.getModel("person-public-profile-models",r.id)}).then(function(e){return(function(e,a,r,n){var i=e.apiResponse,s=e.publicProfileModel;if(i)return i.newNames&&(void 0!==i.newNames.firstName&&s.setValue("firstName",i.newNames.firstName),void 0!==i.newNames.lastName&&s.setValue("lastName",i.newNames.lastName)),i})(e)}.bind(this),e.FetcherErrorLogger(a))}}}),"@VERSION@",{requires:["flickr-promise"],optional:["person-public-profile-models"]});YUI.add("person-public-profile-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-profile-getProfile"].run(t,this.appContext)},updateField:function(t,r){return e.ModelUpdaters["flickr-profile-setProfile"].run(t,r)},updateFirstAndLastName:function(t,r){return e.ModelUpdaters["flickr-account-changeFirstAndLastName"].run(t,r)}},remoteUpdateDescription:function(e,t,r){return this.setValue(e,"description",t.description),this.remote.updateBioField(t,r)},attributes:{nsid:{readOnly:!0,defaultFn:function(e){return e}},joinedDate:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},showcaseSetId:{defaultValue:"0"},city:{},country:{},firstName:{},lastName:{},hometown:{},email:{},occupation:{},profileDescription:{},profileDescriptionExpanded:{},timezone:{},website:{},facebook:{},facebookUrl:{},instagram:{},instagramUrl:{},tumblr:{},tumblrUrl:{},twitter:{},twitterUrl:{},pinterest:{},pinterestUrl:{},totalViews:{},totalTags:{},totalGeotagged:{},totalFaves:{},totalInGroup:{}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-profile-getProfile-fetcher","flickr-profile-setProfile-updater","flickr-account-changeFirstAndLastName-updater","moment"]});YUI.add("flickr-account-changeUsername-updater",(function(e,n){"use strict";e.namespace("ModelUpdaters")["flickr-account-changeUsername"]={run:function(r,o){var s=(function(e){return{username:e.username}})(r);return new e.FlickrPromise({apiResponse:o.callAPI("flickr.account.changeUsername",s),personModel:o.getModel("person-models",r.id)}).then(function(e){return(function(e,n,r,o){var s=e.apiResponse,a=e.personModel;if(s)return s.newUsername&&void 0!==s.newUsername&&a.setValue("username",s.newUsername),s})(e)}.bind(this),e.FetcherErrorLogger(n))}}}),"@VERSION@",{requires:["flickr-promise"],optional:["person-public-profile-models"]});YUI.add("person-model-helper",(function(e){e.PersonModelHelper={attributes:{pathAlias:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||void 0},defaultFn:function(e){return e}},username:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},realname:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},displayname:{readOnly:!0,derivedBy:["username","realname"],getter:function(e,t){return this.getValue(t,"realname")||this.getValue(t,"username")}},nsid:{readOnly:!0,defaultFn:function(e){return e}},url:{readOnly:!0,derivedBy:["pathAlias"],defaultFn:function(e){return"/photos/"+this.getValue(e,"pathAlias")+"/"}},isMe:{readOnly:!0,defaultFn:function(e){var t=this.appContext.getViewer();return t.signedIn&&t.nsid===e}}}}}),"@VERSION@",{requires:[]});YUI.add("person-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},updateUsername:function(t,r){return e.ModelUpdaters["flickr-account-changeUsername"].run(t,r)}},attributes:{pathAlias:e.PersonModelHelper.attributes.pathAlias,username:e.PersonModelHelper.attributes.username,realname:e.PersonModelHelper.attributes.realname,displayname:e.PersonModelHelper.attributes.displayname,nsid:e.PersonModelHelper.attributes.nsid,url:e.PersonModelHelper.attributes.url,isMe:e.PersonModelHelper.attributes.isMe,buddyicon:{},isPro:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},proBadge:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isMinor:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},proExpireDate:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},isDeleted:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},isAdFree:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},isNoAds:{derivedBy:["isPro","isAdFree"],readOnly:!0,getter:function(e,t){var r=this.getValue(t,"isPro"),n=this.getValue(t,"isAdFree");return r||n}},hasStats:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasAdfree:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},has1TB:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},has2TB:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasUnlimitedStorage:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasFreeStandardShipping:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasFreeEducationalResources:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},dateCreated:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},location:{defaultFn:function(){return""}},expiringPartner:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultFn:function(){return!1}},uploadCount:{defaultValue:null},uploadLimit:{defaultValue:null},uploadLimitStatus:{defaultValue:null},isCognitoUser:{defaultValue:null},hasAuthorizedMobile:{defaultValue:null},hasInvalidEmail:{defaultValue:!1},subscription:{defaultValue:{isPastDue:!1,isPro:!1,isClosed:!1}},contactsCacheUrl:{defaultValue:!1},segments:{defaultValue:[]},isEligibleForGifts:{defaultValue:!1},eligibleGifts:{defaultValue:[]},newFlow:{defaultValue:!1},marketingPrefsLink:{defaultValue:"",validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-account-changeUsername-updater","attribute-helpers","person-model-helper","moment"]});YUI.add("flickr-people-getInfo-fetcher",(function(e,s){"use strict";var r=new e.SubscriptionsHelper,o=require("hermes-core/flog")(s);e.namespace("ModelFetchers")["flickr-people-getInfo"]={run:function(r,o){var i=this,t=o.getViewer();return t&&t.signedIn&&(r.id===t.nsid||r.nsid===t.nsid)&&(r.storage=1),new e.FlickrPromise({apiResponse:o.callAPI("flickr.people.getInfo",this._processParams(r,o),!0),personModelRegistry:o.getModelRegistry("person-models"),personRelationshipModelRegistry:o.getModelRegistry("person-relationship-models"),personProfileModelRegistry:o.getModelRegistry("person-profile-models"),personPreferencesModelRegistry:o.getModelRegistry("person-preferences-models"),personGroupsModelRegistry:o.getModelRegistry("person-groups-models"),personNotificationsModelRegistry:o.getModelRegistry("person-notifications-models"),photostreamModelRegistry:o.getModelRegistry("photostream-models"),privilegesModelRegistry:o.getModelRegistry("privileges-models")}).then((function(e){return i._processResponse(e,r,o)}),e.FetcherErrorLogger(s))},_processParams:function(s,r){var o={datecreate:1,extras:e.APIHelper.request.getRebootPeopleExtras()};if(YUI.Env.isServer&&s.id===r.request.probableUser?(o.storage=1,o.extras+=","+["classic_user_id","timezone_dst","unified_search_view_pref","photostream_view_order_pref","photostream_view_as_pref","album_view_layout","download_pref","products_features","subscriptions","is_minor","privileges"].join(",")):r.getViewer().signedIn&&s.id===r.getViewer().nsid&&(o.extras+=","+["products_features","subscriptions"].join(",")),s.extras&&"string"==typeof s.extras&&s.extras.length>0&&(o.extras+=","+s.extras),s.id)o.user_id=s.id;else{if(!s.pathAlias)throw new Error("`fetch` is missing required params.");o.path_alias=s.pathAlias}return s.storage&&(o.storage=s.storage),o.extras||(o.extras=""),o.extras+=", has_stats",o},_processResponse:function(s,i,t){var a,n,l,p=s.apiResponse,d=s.personModelRegistry,g=s.personRelationshipModelRegistry,u=s.personProfileModelRegistry,m=s.personPreferencesModelRegistry,c=s.personGroupsModelRegistry,h=s.personNotificationsModelRegistry,f=s.photostreamModelRegistry,v=s.privilegesModelRegistry,y=p.person,M=t.getViewer(),R=y.id,P=M&&M.signedIn&&R===M.nsid;return l={id:R,pathAlias:y.pathAlias,username:y.username&&y.username._content,realname:y.realname&&y.realname._content,buddyicon:e.APIHelper.response.removeProtocolFromURL(y.iconurls),isAdFree:y.isAdFree,isPro:y.ispro,proBadge:y.proBadge,isMinor:y.isMinor,hasStats:y.hasStats,location:y.location&&y.location._content,hasAdfree:y.hasAdfree,has1TB:y.has1TB,has2TB:y.has2TB,hasUnlimitedStorage:y.hasUnlimitedStorage,hasFreeStandardShipping:y.hasFreeStandardShipping,hasFreeEducationalResources:y.hasFreeEducationalResources,dateCreated:y.datecreate._content,expiringPartner:y.expiringPartner},y.ispro&&(l.proExpireDate=y.expire),y.gift&&(l.isEligibleForGifts=y.gift.giftEligible||!1,l.eligibleGifts=y.gift.eligibleDurations||[],l.newFlow=y.gift.newFlow||!1),P&&(y.uploadLimits?(l.uploadLimit=y.uploadLimits.uploadLimit,l.uploadCount=y.uploadLimits.uploadCount):(l.uploadLimit=y.uploadLimit,l.uploadCount=y.uploadCount),l.uploadLimitStatus=y.uploadLimitStatus,l.isCognitoUser=y.isCognitoUser,l.hasInvalidEmail=!1,y.email&&(!y.email||y.email._content&&""!==y.email._content)?y.email._content&&-1===y.email._content.indexOf("@")?l.hasInvalidEmail=!0:l.hasInvalidEmail=!1:l.hasInvalidEmail=!0,l.isPro&&(l.subscription=r.parseEffectiveSubscriptionData(!0,p.effectiveSubscriptions)),y.contactsCacheUrl&&(l.contactsCacheUrl=y.contactsCacheUrl),y.segments&&y.segments.length?(l.segments=y.segments,o.info("User belongs to these segments",l.segments)):o.info("User is not in any segment"),y.email&&y.email.prefsLink&&(l.marketingPrefsLink=y.email.prefsLink)),d.addOrUpdate(l),h.addOrUpdate({id:R,unreadFlickrMailCount:y.unreadMessages?y.unreadMessages.content:0}),g.addOrUpdate({id:R,pathAlias:y.pathAlias,isContact:y.contact,isFriend:y.friend,isFamily:y.family,isIgnored:y.ignored,isIgnoredBy:y.ignoredby,isRevContact:y.revcontact,isRevFriend:y.revfriend,isRevFamily:y.revfamily}),P&&(n={id:R},y.safeSearch&&(n.safeSearch=(y.safeSearch||1)-1),y.viewPrefs&&(n.unifiedSearchViewPref=y.viewPrefs.unifiedSearchViewPref,n.photostreamViewOrderPref=y.viewPrefs.photostreamViewOrderPref,n.photostreamViewAsPref=y.viewPrefs.photostreamViewAsPref,n.albumViewLayoutPref=y.viewPrefs.albumViewLayout,n.galleryViewLayoutPref=y.viewPrefs.galleriesViewLayoutPref,n.photostreamViewLayoutPref=y.viewPrefs.photostreamLayoutType),m.exists(R)?m.setValues(R,n):m.add(n),y.privileges&&v.addOrUpdate({id:R,privileges:y.privileges,uploadLimits:y.uploadLimits})),a={id:R,coverPhotoUrls:e.APIHelper.response.removeProtocolFromURL(y.coverphoto_url),photoCount:y.photos.count.content,location:y.location?y.location.content:null,arrPhotoCount:y.all_rights_reserved_photos_count},y.storage&&(a.storageUsed=y.storage.used.content,a.storageTotal=y.storage.total.content),y.unreadMessages&&(a.unreadMessages=y.unreadMessages.content),u.addOrUpdate(a),c.addOrUpdate({id:R,memberCount:y.groupMemberships?y.groupMemberships.member:null,moderatorCount:y.groupMemberships?y.groupMemberships.moderator:null,adminCount:y.groupMemberships?y.groupMemberships.admin:null,invitedCount:y.groupMemberships?y.groupMemberships.invited:null}),f.addOrUpdate({id:R,pathAlias:y.pathAlias,owner:d.proxy(R),totalItems:y.photos.count&&y.photos.count.content}),y}}}),"@VERSION@",{requires:["flickr-promise","subscriptions-helper"],optionalRequires:["hermes-core"],optional:["person-models","person-relationship-models","person-preferences-models","person-profile-models","person-groups-models","photostream-models","person-notifications-models","privileges-models","api-helper"]});YUI.add("person-relationship-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,i){var r=[],n={};return e.Lang.isObject(i,!0)&&(n.user_id=t,n.friend=this.getValue(t,"isFriend"),n.family=this.getValue(t,"isFamily"),"isContact"in i&&(i.isContact.newVal?r.push(e.ModelUpdaters["flickr-contacts-add"].run(n,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-remove"].run(n,this.appContext))),("isFriend"in i||"isFamily"in i)&&("isFriend"in i&&(n.friend=i.isFriend.newVal),"isFamily"in i&&(n.family=i.isFamily.newVal),r.push(e.ModelUpdaters["flickr-contacts-edit"].run(n,this.appContext))),"isIgnored"in i&&(!0===i.isIgnored.newVal?r.push(e.ModelUpdaters["flickr-contacts-block"].run(n,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-unblock"].run(n,this.appContext)))),e.Promise.all(r)}},toggleFollowing:function(e){this.getValue(e,"isContact")?this.setValue(e,"isContact",!1):this.setValue(e,"isContact",!0)},toggleFriend:function(e){this.getValue(e,"isFriend")?this.setValue(e,"isFriend",!1):this.setValue(e,"isFriend",!0)},toggleFamily:function(e){this.getValue(e,"isFamily")?this.setValue(e,"isFamily",!1):this.setValue(e,"isFamily",!0)},toggleIgnore:function(e){this.getValue(e,"isIgnored")?this.setValue(e,"isIgnored",!1):this.setValue(e,"isIgnored",!0)},attributes:{pathAlias:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnoredBy:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnored:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMe:{readOnly:!0,getter:function(e,t){var i=this.appContext.getViewer();return!!i&&this.getValue(t,"nsid")===i.nsid}},nsid:{readOnly:!0,defaultFn:function(e){return e}}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-contacts-add-updater","flickr-contacts-remove-updater","flickr-contacts-edit-updater","flickr-contacts-block-updater","flickr-contacts-unblock-updater","attribute-helpers"]});YUI.add("math-helper",(function(e){e.MathHelper=function(e){return{seedRandom:function(e){return 0+1*((e=(9301*e+49297)%233280)/233280)}}}}),"@VERSION@",{requires:[]});