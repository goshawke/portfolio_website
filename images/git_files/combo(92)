YUI.add("photo-exif-models",(function(e){function r(e){r.superclass.constructor.call(this,e)}e.Models[this.name]=r,e.extend(r,e.FlickrModelRegistry,{name:this.name,remote:{read:function(r){return e.ModelFetchers["flickr-photos-getExif"].run(r,this.appContext).then((function(e){return e}),(function(){}))}},attributes:{camera:{},cameraType:{},cameraURL:{},cameraMake:{},cameraModel:{},data:{},exposureProgram:{},exposureTime:{},flash:{},flashFired:{},flashModeOff:{},flashModeOn:{},flashModeAuto:{},fNumber:{},focalLength:{},iso:{},lensModel:{},software:{},meteringMode:{}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getExif-fetcher"]});YUI.add("flickr-photos-getExif-fetcher",(function(e,a){"use strict";e.namespace("ModelFetchers")["flickr-photos-getExif"]={run:function(t,o){var r,s=t.id,l=this;return r={photo_id:s,extras:"camera"},e.Promise.all([o.callAPI("flickr.photos.getExif",r),o.getModelRegistry("photo-exif-models")]).then((function(e){return l._processResponse(e,t,o)}),(function(r){return 2===r.code?o.getModelRegistry("photo-exif-models").then((function(e){return e.addOrUpdate({id:t.id})})):e.FetcherErrorLogger(a)(r)}))},_processResponse:function(e,a,t){var o,r,s,l=e[0],n=e[1],f=16*Math.pow(2,10);if(l.photo)return o=e[0].photo.exif||[],r=e[0].photo.camera,s={id:a.id,camera:r,cameraType:e[0].photo.camera_type,cameraURL:e[0].photo.camera_url,data:[],flashFired:null,flashModeOff:null,flashModeOn:null,flashModeAuto:null,meteringMode:null},o.forEach((function(e){var a,t,o;e.tag&&e.raw&&("string"==typeof e.tag&&(0===(t=e.tag.search(/([A-Z][a-z])/))?t=1:-1===t&&(t=e.tag.length),o=e.tag.slice(0,t).toLowerCase()+e.tag.slice(t)),e.raw.content.length>f&&(e.raw.content=e.raw.content.substr(0,f)),o&&("make"===o.toLowerCase()&&(s.cameraMake=e.raw.content),"model"===o.toLowerCase()&&(s.cameraModel=e.raw.content)),s[o]=a=e.raw.content,s.data.push({label:e.label,value:a}))})),[["lensModel","lens"]].forEach((function(e){for(var a=e.shift();e.length&&void 0===s[a];)s[a]=s[e.shift()]})),s.flash&&(s.flash.match(/on|fired/i)&&!s.flash.match(/did not/i)?s.flashFired=!0:s.flashFired=!1,s.flash=s.flash.substr(0,1).toUpperCase()+s.flash.substr(1).toLowerCase(),s.flash.match(/auto/i)?s.flashModeAuto=!0:s.flash.match(/on/i)?s.flashModeOn=!0:s.flash.match(/off|no flash/i)&&(s.flashModeOff=!0)),n.addOrUpdate(s)}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-exif-models"]});